<!DOCTYPE html>
<html lang="zh-CN">
    <!-- title -->


    

<!-- keywords -->



<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="author" content="Drunkmars">
    <meta name="renderer" content="webkit">
    <meta name="copyright" content="Drunkmars">
    
        <meta name="keywords" content="Drunkmars,Drunkmars-theme,Drunkmars-blog">
    
    <meta name="description" content="">
    <meta name="description" content="本文记录一下自己win32的学习过程。">
<meta property="og:type" content="article">
<meta property="og:title" content="win32">
<meta property="og:url" content="http://example.com/2021/06/17/win32/index.html">
<meta property="og:site_name" content="Drunkmars">
<meta property="og:description" content="本文记录一下自己win32的学习过程。">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/images/win32/image-20210616213621999.png">
<meta property="og:image" content="http://example.com/images/win32/image-20210616214139019.png">
<meta property="og:image" content="http://example.com/images/win32/image-20210616215012176.png">
<meta property="og:image" content="http://example.com/images/win32/image-20210616214829289.png">
<meta property="og:image" content="http://example.com/images/win32/image-20210616214942489.png">
<meta property="og:image" content="http://example.com/images/win32/image-20210616215841379.png">
<meta property="og:image" content="http://example.com/images/win32/image-20210616220745696.png">
<meta property="og:image" content="http://example.com/images/win32/image-20210616222606638.png">
<meta property="og:image" content="http://example.com/images/win32/image-20210616223420517.png">
<meta property="og:image" content="http://example.com/images/win32/image-20210616233547634.png">
<meta property="og:image" content="http://example.com/images/win32/image-20210617104655908.png">
<meta property="og:image" content="http://example.com/images/win32/image-20210617104924348.png">
<meta property="og:image" content="http://example.com/images/win32/image-20210617112456750.png">
<meta property="og:image" content="http://example.com/images/win32/image-20210617112445040.png">
<meta property="og:image" content="http://example.com/images/win32/image-20210617112832139.png">
<meta property="og:image" content="http://example.com/images/win32/image-20210617112920079.png">
<meta property="og:image" content="http://example.com/images/win32/image-20210617113748486.png">
<meta property="og:image" content="http://example.com/images/win32/image-20210617113916378.png">
<meta property="og:image" content="http://example.com/images/win32/image-20210617114028142.png">
<meta property="og:image" content="http://example.com/images/win32/image-20210617114154318.png">
<meta property="og:image" content="http://example.com/images/win32/image-20210617114337607.png">
<meta property="og:image" content="http://example.com/images/win32/image-20210617114629498.png">
<meta property="og:image" content="http://example.com/images/win32/image-20210617161409243.png">
<meta property="og:image" content="http://example.com/images/win32/image-20210617162136830.png">
<meta property="og:image" content="http://example.com/images/win32/image-20210617191945755.png">
<meta property="og:image" content="http://example.com/images/win32/image-20210617193425020.png">
<meta property="og:image" content="http://example.com/images/win32/image-20210617220012819.png">
<meta property="og:image" content="http://example.com/images/win32/image-20210617220327317.png">
<meta property="og:image" content="http://example.com/images/win32/image-20210617221349107.png">
<meta property="og:image" content="http://example.com/images/win32/image-20210617224028505.png">
<meta property="og:image" content="http://example.com/images/win32/image-20210618111859266.png">
<meta property="og:image" content="http://example.com/images/win32/image-20210618111823935.png">
<meta property="og:image" content="http://example.com/images/win32/image-20210618112720123.png">
<meta property="og:image" content="http://example.com/images/win32/image-20210618114820809.png">
<meta property="og:image" content="http://example.com/images/win32/image-20210618114847274.png">
<meta property="og:image" content="http://example.com/images/win32/image-20210618113043584.png">
<meta property="og:image" content="http://example.com/images/win32/image-20210618113141490.png">
<meta property="og:image" content="http://example.com/images/win32/image-20210618113245997.png">
<meta property="og:image" content="http://example.com/images/win32/image-20210618113708302.png">
<meta property="og:image" content="http://example.com/images/win32/image-20210618114312461.png">
<meta property="og:image" content="http://example.com/images/win32/image-20210619125144253.png">
<meta property="og:image" content="http://example.com/images/win32/image-20210619125301285.png">
<meta property="og:image" content="http://example.com/images/win32/image-20210619125554262.png">
<meta property="og:image" content="http://example.com/images/win32/image-20210619125602231.png">
<meta property="og:image" content="http://example.com/images/win32/image-20210619132100707.png">
<meta property="og:image" content="http://example.com/images/win32/image-20210619132527542.png">
<meta property="og:image" content="http://example.com/images/win32/image-20210619132231065.png">
<meta property="og:image" content="http://example.com/images/win32/image-20210619150650432.png">
<meta property="og:image" content="http://example.com/images/win32/image-20210619152434258.png">
<meta property="og:image" content="http://example.com/images/win32/image-20210619152106892.png">
<meta property="og:image" content="http://example.com/images/win32/image-20210619152330928.png">
<meta property="og:image" content="http://example.com/images/win32/image-20210619152619778.png">
<meta property="og:image" content="http://example.com/images/win32/image-20210619152612517.png">
<meta property="og:image" content="http://example.com/images/win32/image-20210619155718107.png">
<meta property="og:image" content="http://example.com/images/win32/image-20210619155911660.png">
<meta property="og:image" content="http://example.com/images/win32/image-20210619160259786.png">
<meta property="og:image" content="http://example.com/images/win32/image-20210619160504252.png">
<meta property="og:image" content="http://example.com/images/win32/image-20210619160837419.png">
<meta property="og:image" content="http://example.com/images/win32/image-20210619161810808.png">
<meta property="og:image" content="http://example.com/images/win32/image-20210619162327715.png">
<meta property="og:image" content="http://example.com/images/win32/image-20210619162351805.png">
<meta property="og:image" content="http://example.com/images/win32/image-20210619162442174.png">
<meta property="og:image" content="http://example.com/images/win32/image-20210619163533117.png">
<meta property="og:image" content="http://example.com/images/win32/image-20210619163603546.png">
<meta property="og:image" content="http://example.com/images/win32/image-20210619164220495.png">
<meta property="og:image" content="http://example.com/images/win32/image-20210619164707475.png">
<meta property="og:image" content="http://example.com/images/win32/image-20210619164726395.png">
<meta property="og:image" content="http://example.com/images/win32/image-20210619165504266.png">
<meta property="og:image" content="http://example.com/images/win32/image-20210619175031985.png">
<meta property="og:image" content="http://example.com/images/win32/image-20210619175210746.png">
<meta property="og:image" content="http://example.com/images/win32/image-20210619175228503.png">
<meta property="og:image" content="http://example.com/images/win32/image-20210619175255745.png">
<meta property="og:image" content="http://example.com/images/win32/image-20210619174334794.png">
<meta property="og:image" content="http://example.com/images/win32/image-20210619180135244.png">
<meta property="og:image" content="http://example.com/images/win32/image-20210619175417743.png">
<meta property="og:image" content="http://example.com/images/win32/image-20210619175403377.png">
<meta property="og:image" content="http://example.com/images/win32/image-20210619175815807.png">
<meta property="og:image" content="http://example.com/images/win32/image-20210619175840948.png">
<meta property="og:image" content="http://example.com/images/win32/image-20210619175932395.png">
<meta property="og:image" content="http://example.com/images/win32/image-20210620163232033.png">
<meta property="og:image" content="http://example.com/images/win32/image-20210620163251191.png">
<meta property="og:image" content="http://example.com/images/win32/image-20210620165019695.png">
<meta property="og:image" content="http://example.com/images/win32/image-20210620171245819.png">
<meta property="og:image" content="http://example.com/images/win32/image-20210620172152989.png">
<meta property="og:image" content="http://example.com/images/win32/image-20210620172504902.png">
<meta property="og:image" content="http://example.com/images/win32/image-20210620202158326.png">
<meta property="og:image" content="http://example.com/images/win32/image-20210620205445014.png">
<meta property="og:image" content="http://example.com/images/win32/image-20210620205831080.png">
<meta property="og:image" content="http://example.com/images/win32/image-20210620210029004.png">
<meta property="og:image" content="http://example.com/images/win32/image-20210620210545289.png">
<meta property="og:image" content="http://example.com/images/win32/image-20210620210735200.png">
<meta property="og:image" content="http://example.com/images/win32/image-20210620210803068.png">
<meta property="og:image" content="http://example.com/images/win32/image-20210620210847654.png">
<meta property="og:image" content="http://example.com/images/win32/image-20210620211241714.png">
<meta property="og:image" content="http://example.com/images/win32/image-20210620211411587.png">
<meta property="og:image" content="http://example.com/images/win32/image-20210620211614399.png">
<meta property="og:image" content="http://example.com/images/win32/image-20210620211648507.png">
<meta property="og:image" content="http://example.com/images/win32/image-20210620230508428.png">
<meta property="og:image" content="http://example.com/images/win32/image-20210620230539325.png">
<meta property="og:image" content="http://example.com/images/win32/image-20210620230655585.png">
<meta property="og:image" content="http://example.com/images/win32/image-20210620230748904.png">
<meta property="og:image" content="http://example.com/images/win32/image-20210620231102040.png">
<meta property="og:image" content="http://example.com/images/win32/image-20210620231237414.png">
<meta property="og:image" content="http://example.com/images/win32/image-20210620233834254.png">
<meta property="og:image" content="http://example.com/images/win32/image-20210620233808235.png">
<meta property="og:image" content="http://example.com/images/win32/image-20210620234323295.png">
<meta property="og:image" content="http://example.com/images/win32/image-20210620234353567.png">
<meta property="og:image" content="http://example.com/images/win32/image-20210620234905046.png">
<meta property="og:image" content="http://example.com/images/win32/image-20210620235018754.png">
<meta property="og:image" content="http://example.com/images/win32/image-20210620235227154.png">
<meta property="og:image" content="http://example.com/images/win32/image-20210620235550092.png">
<meta property="og:image" content="http://example.com/images/win32/image-20210621000120585.png">
<meta property="og:image" content="http://example.com/images/win32/image-20210621000150472.png">
<meta property="og:image" content="http://example.com/images/win32/image-20210621000200689.png">
<meta property="og:image" content="http://example.com/images/win32/image-20210621000821115.png">
<meta property="article:published_time" content="2021-06-16T16:00:00.000Z">
<meta property="article:modified_time" content="2021-06-21T15:42:15.309Z">
<meta property="article:author" content="Drunkmars">
<meta property="article:tag" content="二进制">
<meta property="article:tag" content="windows api">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/images/win32/image-20210616213621999.png">
    <meta http-equiv="Cache-control" content="no-cache">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <link rel="icon" href="/assets/Drunkmars.ico">
    
    <title>win32 · Drunkmars&#39;s Blog</title>
    <!-- /*! loadCSS. [c]2017 Filament Group, Inc. MIT License */
/* This file is meant as a standalone workflow for
- testing support for link[rel=preload]
- enabling async CSS loading in browsers that do not support rel=preload
- applying rel preload css once loaded, whether supported or not.
*/ -->
<script>
    (function (w) {
        'use strict'
        // rel=preload support test
        if (!w.loadCSS) {
            w.loadCSS = function () {}
        }
        // define on the loadCSS obj
        var rp = (loadCSS.relpreload = {})
        // rel=preload feature support test
        // runs once and returns a function for compat purposes
        rp.support = (function () {
            var ret
            try {
                ret = w.document.createElement('link').relList.supports('preload')
            } catch (e) {
                ret = false
            }
            return function () {
                return ret
            }
        })()

        // if preload isn't supported, get an asynchronous load by using a non-matching media attribute
        // then change that media back to its intended value on load
        rp.bindMediaToggle = function (link) {
            // remember existing media attr for ultimate state, or default to 'all'
            var finalMedia = link.media || 'all'

            function enableStylesheet() {
                link.media = finalMedia
            }

            // bind load handlers to enable media
            if (link.addEventListener) {
                link.addEventListener('load', enableStylesheet)
            } else if (link.attachEvent) {
                link.attachEvent('onload', enableStylesheet)
            }

            // Set rel and non-applicable media type to start an async request
            // note: timeout allows this to happen async to let rendering continue in IE
            setTimeout(function () {
                link.rel = 'stylesheet'
                link.media = 'only x'
            })
            // also enable media after 3 seconds,
            // which will catch very old browsers (android 2.x, old firefox) that don't support onload on link
            setTimeout(enableStylesheet, 3000)
        }

        // loop through link elements in DOM
        rp.poly = function () {
            // double check this to prevent external calls from running
            if (rp.support()) {
                return
            }
            var links = w.document.getElementsByTagName('link')
            for (var i = 0; i < links.length; i++) {
                var link = links[i]
                // qualify links to those with rel=preload and as=style attrs
                if (
                    link.rel === 'preload' &&
                    link.getAttribute('as') === 'style' &&
                    !link.getAttribute('data-loadcss')
                ) {
                    // prevent rerunning on link
                    link.setAttribute('data-loadcss', true)
                    // bind listeners to toggle media back
                    rp.bindMediaToggle(link)
                }
            }
        }

        // if unsupported, run the polyfill
        if (!rp.support()) {
            // run once at least
            rp.poly()

            // rerun poly on an interval until onload
            var run = w.setInterval(rp.poly, 500)
            if (w.addEventListener) {
                w.addEventListener('load', function () {
                    rp.poly()
                    w.clearInterval(run)
                })
            } else if (w.attachEvent) {
                w.attachEvent('onload', function () {
                    rp.poly()
                    w.clearInterval(run)
                })
            }
        }

        // commonjs
        if (typeof exports !== 'undefined') {
            exports.loadCSS = loadCSS
        } else {
            w.loadCSS = loadCSS
        }
    })(typeof global !== 'undefined' ? global : this)
</script>

    <style type="text/css">
    @font-face {
        font-family: 'Oswald-Regular';
        src: url("/font/Oswald-Regular.ttf");
    }

    body {
        margin: 0;
    }

    header,
    footer,
    .back-top,
    .sidebar,
    .container,
    .site-intro-meta,
    .toc-wrapper {
        display: none;
    }

    .site-intro {
        position: relative;
        z-index: 3;
        width: 100%;
        /* height: 50vh; */
        overflow: hidden;
    }

    .site-intro-placeholder {
        position: absolute;
        z-index: -2;
        top: 0;
        left: 0;
        width: calc(100% + 300px);
        height: 100%;
        background: repeating-linear-gradient(-45deg, #444 0, #444 80px, #333 80px, #333 160px);
        background-position: center center;
        transform: translate3d(-226px, 0, 0);
        animation: gradient-move 2.5s ease-out 0s infinite;
    }

    @keyframes gradient-move {
        0% {
            transform: translate3d(-226px, 0, 0);
        }
        100% {
            transform: translate3d(0, 0, 0);
        }
    }
</style>

    <link rel="preload" href="/css/style.css?v=20210823" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <link rel="preload" href="/css/dark.css?v=20210823" as="style">
    <link rel="stylesheet" href="/css/dark.css" media="(prefers-color-scheme: dark)">
    <link rel="stylesheet" href="/css/mobile.css?v=20210823" media="(max-width: 960px)">
    <link rel="preload" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <link rel="preload" href="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" as="script">
    <link rel="preload" href="/scripts/main.js?v=20210823" as="script">
    <link rel="preload" href="/scripts/dark.js?v=20210823" as="script">
    <link rel="preload" href="/font/Oswald-Regular.ttf" as="font" crossorigin>
    <link rel="preload" href="https://at.alicdn.com/t/font_327081_1dta1rlogw17zaor.woff" as="font" crossorigin>
    <!-- algolia -->
    
    <!-- 百度统计  -->
    
    <!-- 谷歌统计  -->
    
<meta name="generator" content="Hexo 5.4.0"></head>

    <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js"></script>
    <script type="text/javascript">
        if (typeof window.$ == undefined) {
            console.warn('jquery load from jsdelivr failed, will load local script')
            document.write('<script src="/lib/jquery.min.js" />')
        }
    </script>
    
        <body class="post-body">
    
        <!-- header -->
        <header class="header header-mobile">
    <!-- top read progress line -->
    <div class="header-element">
        <div class="read-progress"></div>
    </div>
    <!-- sidebar menu button -->
    <div class="header-element">
        
            <div class="header-sidebar-menu">
        
            
                <div style="padding-left: 1px;">&#xe775;</div>
            
        </div>
    </div>
    <!-- header actions -->
    <div class="header-actions">
        <!-- theme mode switch button -->
        <span class="header-theme-btn header-element">
            <i class="fas fa-adjust"></i>
        </span>
        <!-- back to home page text -->
        <span class="home-link header-element">
            <a href=/>Drunkmars's Blog</a>
        </span>
    </div>
    <!-- toggle banner for post layout -->
    
        
            <div class="banner">
        
            <div class="blog-title header-element">
                <a href="/">Drunkmars&#39;s Blog</a>
            </div>
            <div class="post-title header-element">
                <a href="#" class="post-name">win32</a>
            </div>
        </div>
    
</header>

        <!-- fixed footer -->
        <footer class="footer-fixed">
    <!-- back to top button -->
    <div class="footer-fixed-element">
        
            <div class="back-top back-top-hidden">
        
        
            <div>&#xe639;</div>
        
        </div>
    </div>
</footer>

        <!-- wrapper -->
        <div class="wrapper">
            <div class="site-intro" style="







    height:50vh;

">
    
    <!-- 主页  -->
    
        
    <!-- 404页  -->
            
    <div class="site-intro-placeholder"></div>
    <div class="site-intro-img" style="background-image: url(/intro/post-bg.jpg)"></div>
    <div class="site-intro-meta">
        <!-- 标题  -->
        <h1 class="intro-title">
            <!-- 主页  -->
            
                win32
            <!-- 404 -->
            
        </h1>
        <!-- 副标题 -->
        <p class="intro-subtitle">
            <!-- 主页副标题  -->
            
                
            <!-- 404 -->
            
        </p>
        <!-- 文章页 meta -->
        
            <div class="post-intros">
                <!-- 文章页标签  -->
                
                    <div class= post-intro-tags >
    
    
        <a class="post-tag" href="javascript:void(0);" data-tags="二进制">二进制</a>
    
        <a class="post-tag" href="javascript:void(0);" data-tags="windows api">windows api</a>
    
</div>

                
                
                    <div class="post-intro-read">
                        <span>字数统计: <span class="post-count word-count">7.6k</span>阅读时长: <span class="post-count reading-time">31 min</span></span>
                    </div>
                
                <div class="post-intro-meta">
                    <!-- 撰写日期 -->
                    <span class="iconfont-archer post-intro-calander">&#xe676;</span>
                    <span class="post-intro-time">2021/06/17</span>
                    <!-- busuanzi -->
                    
                        <span id="busuanzi_container_page_pv" class="busuanzi-pv">
                            <span class="iconfont-archer post-intro-busuanzi">&#xe602;</span>
                            <span id="busuanzi_value_page_pv"></span>
                        </span>
                    
                    <!-- 文章分享 -->
                    <span class="share-wrapper">
                        <span class="iconfont-archer share-icon">&#xe71d;</span>
                        <span class="share-text">Share</span>
                        <ul class="share-list">
                            <li class="iconfont-archer share-qr" data-type="qr">&#xe75b;
                                <div class="share-qrcode"></div>
                            </li>
                            <li class="iconfont-archer" data-type="weibo">&#xe619;</li>
                            <li class="iconfont-archer" data-type="qzone">&#xe62e;</li>
                            <li class="iconfont-archer" data-type="twitter">&#xe634;</li>
                            <li class="iconfont-archer" data-type="facebook">&#xe67a;</li>
                        </ul>
                    </span>
                </div>
            </div>
        
    </div>
</div>

            <script>
  // get user agent
  function getBrowserVersions() {
    var u = window.navigator.userAgent
    return {
      userAgent: u,
      trident: u.indexOf('Trident') > -1, //IE内核
      presto: u.indexOf('Presto') > -1, //opera内核
      webKit: u.indexOf('AppleWebKit') > -1, //苹果、谷歌内核
      gecko: u.indexOf('Gecko') > -1 && u.indexOf('KHTML') == -1, //火狐内核
      mobile: !!u.match(/AppleWebKit.*Mobile.*/), //是否为移动终端
      ios: !!u.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/), //ios终端
      android: u.indexOf('Android') > -1 || u.indexOf('Linux') > -1, //android终端或者uc浏览器
      iPhone: u.indexOf('iPhone') > -1 || u.indexOf('Mac') > -1, //是否为iPhone或者安卓QQ浏览器
      iPad: u.indexOf('iPad') > -1, //是否为iPad
      webApp: u.indexOf('Safari') == -1, //是否为web应用程序，没有头部与底部
      weixin: u.indexOf('MicroMessenger') == -1, //是否为微信浏览器
      uc: u.indexOf('UCBrowser') > -1, //是否为android下的UC浏览器
    }
  }
  var browser = {
    versions: getBrowserVersions(),
  }
  console.log('userAgent: ' + browser.versions.userAgent)

  // callback
  function fontLoaded() {
    console.log('font loaded')
    if (document.getElementsByClassName('site-intro-meta')) {
      document
        .getElementsByClassName('intro-title')[0]
        .classList.add('intro-fade-in')
      document
        .getElementsByClassName('intro-subtitle')[0]
        .classList.add('intro-fade-in')
      var postIntros = document.getElementsByClassName('post-intros')[0]
      if (postIntros) {
        postIntros.classList.add('post-fade-in')
      }
    }
  }

  // UC不支持跨域，所以直接显示
  function asyncCb() {
    if (browser.versions.uc) {
      console.log('UCBrowser')
      fontLoaded()
    } else {
      WebFont.load({
        custom: {
          families: ['Oswald-Regular'],
        },
        loading: function () {
          // 所有字体开始加载
          // console.log('font loading');
        },
        active: function () {
          // 所有字体已渲染
          fontLoaded()
        },
        inactive: function () {
          // 字体预加载失败，无效字体或浏览器不支持加载
          console.log('inactive: timeout')
          fontLoaded()
        },
        timeout: 5000, // Set the timeout to two seconds
      })
    }
  }

  function asyncErr() {
    console.warn('script load from CDN failed, will load local script')
  }

  // load webfont-loader async, and add callback function
  function async(u, cb, err) {
    var d = document,
      t = 'script',
      o = d.createElement(t),
      s = d.getElementsByTagName(t)[0]
    o.src = u
    if (cb) {
      o.addEventListener(
        'load',
        function (e) {
          cb(null, e)
        },
        false
      )
    }
    if (err) {
      o.addEventListener(
        'error',
        function (e) {
          err(null, e)
        },
        false
      )
    }
    s.parentNode.insertBefore(o, s)
  }

  var asyncLoadWithFallBack = function (arr, success, reject) {
    var currReject = function () {
      reject()
      arr.shift()
      if (arr.length) async(arr[0], success, currReject)
    }

    async(arr[0], success, currReject)
  }

  asyncLoadWithFallBack(
    [
      'https://cdn.jsdelivr.net/npm/webfontloader@1.6.28/webfontloader.min.js',
      'https://cdn.bootcss.com/webfont/1.6.28/webfontloader.js',
      "/lib/webfontloader.min.js",
    ],
    asyncCb,
    asyncErr
  )
</script>

            <img class="loading" src="/assets/loading.svg" style="display: block; margin: 6rem auto 0 auto; width: 6rem; height: 6rem;" />
            <div class="container container-unloaded">
                <main class="main post-page">
    <article class="article-entry">
        <p>本文记录一下自己win32的学习过程。</p>
<span id="more"></span>

<h1 id="win32-宽字节"><a href="#win32-宽字节" class="headerlink" title="win32 宽字节"></a>win32 宽字节</h1><h2 id="多字节字符"><a href="#多字节字符" class="headerlink" title="多字节字符"></a>多字节字符</h2><h3 id="ascii"><a href="#ascii" class="headerlink" title="ascii"></a>ascii</h3><blockquote>
<p>1、ASCII 码使用指定的 7 位或 8 位二进制数组合来表示 128 或 256 种可能的字符。                    </p>
<p>2、标准 ASCII 码使用 7 位二进制数来表示所有的大写和小写字母，数字 0 到 9、标点符号，以及在美式英语中使用的特殊控制字符。                    </p>
<p>3、扩展 ASCII 码允许将每个字符的第 8 位用于确定附加的 128 个特殊符号字符、外来语字母和图形符号。                    </p>
</blockquote>
<h3 id="GB2312"><a href="#GB2312" class="headerlink" title="GB2312"></a>GB2312</h3><p>计算机发明之处及后面很长一段时间，只用应用于美国及西方一些发达国家，ASCII能够很好满足用户的需求。但是当天朝也有了计算机之后，为了显示中文，必须设计一套编码规则用于将汉字转换为计算机可以接受的数字系统的数。天朝专家把那些127号之后的奇异符号们（即EASCII）取消掉，规定：一个小于127的字符的意义与原来相同，但两个大于127的字符连在一起时，就表示一个汉字，前面的一个字节（他称之为高字节）从0xA1用到 0xF7，后面一个字节（低字节）从0xA1到0xFE，这样我们就可以组合出大约7000多个简体汉字了。</p>
<p>在这些编码里，还把数学符号、罗马希腊的 字母、日文的假名们都编进去了，连在ASCII里本来就有的数字、标点、字母都统统重新编了两个字节长的编码，这就是常说的”全角”字符，而原来在127号以下的那些就叫”半角”字符了。</p>
<p>上述编码规则就是GB2312或GB2312-80</p>
<h2 id="C语言中的宽字符"><a href="#C语言中的宽字符" class="headerlink" title="C语言中的宽字符"></a>C语言中的宽字符</h2><h3 id="宽字符的使用"><a href="#宽字符的使用" class="headerlink" title="宽字符的使用"></a>宽字符的使用</h3><p>“中”字的编码：    </p>
<p>ASCII：d6 d0<br>UNICODE：4e 2d     </p>
<p>这里先测试一下，正常的查表是查ASCII码表，char取一字节，所以这里x在内存中的值为D0</p>
<p><img src="/images/win32/image-20210616213621999.png" alt="image-20210616213621999"></p>
<p>使用<code>L&#39;中&#39;</code>即可让编译器查UNICODE码表，用<code>wchar_t</code>取两字节，查看y在内存的值为4E 2D</p>
<p><img src="/images/win32/image-20210616214139019.png" alt="image-20210616214139019"></p>
<h3 id="宽字符串的使用"><a href="#宽字符串的使用" class="headerlink" title="宽字符串的使用"></a>宽字符串的使用</h3><p><img src="/images/win32/image-20210616215012176.png" alt="image-20210616215012176"></p>
<p>使用拓展ASCII编码表 以00结尾</p>
<p><img src="/images/win32/image-20210616214829289.png" alt="image-20210616214829289"></p>
<p>使用UNICODE编码表 以00 00结尾</p>
<p><img src="/images/win32/image-20210616214942489.png" alt="image-20210616214942489"></p>
<h3 id="在控制台打印"><a href="#在控制台打印" class="headerlink" title="在控制台打印"></a>在控制台打印</h3><p>这里使用L配合<code>wprint</code>打印默认是输出英文所以这里显示不出来</p>
<p><img src="/images/win32/image-20210616215841379.png" alt="image-20210616215841379"></p>
<p>设置地域即可</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;locale.h&gt;</span><br><span class="line"></span><br><span class="line">setlocale(LC_ALL,&quot;&quot;);</span><br></pre></td></tr></table></figure>



<p><img src="/images/win32/image-20210616220745696.png" alt="image-20210616220745696"></p>
<h3 id="字符串长度"><a href="#字符串长度" class="headerlink" title="字符串长度"></a>字符串长度</h3><p><img src="/images/win32/image-20210616222606638.png" alt="image-20210616222606638"></p>
<h3 id="字符串复制"><a href="#字符串复制" class="headerlink" title="字符串复制"></a>字符串复制</h3><p><img src="/images/win32/image-20210616223420517.png" alt="image-20210616223420517"></p>
<h2 id="win32-API中的宽字符"><a href="#win32-API中的宽字符" class="headerlink" title="win32 API中的宽字符"></a>win32 API中的宽字符</h2><h3 id="win32api"><a href="#win32api" class="headerlink" title="win32api"></a>win32api</h3><p><strong>Windows操作系统应用程序接口</strong>（Windows API），有非正式的简称法为<strong>WinAPI</strong>，是<a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E5%BE%AE%E8%BD%AF">微软</a>对于<a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/Windows">Windows</a><a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F">操作系统</a>中可用的核心<a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/API">应用程序编程接口</a>的称法。它被设计为各种语言的程序调用，也是<a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E5%BA%94%E7%94%A8%E8%BD%AF%E4%BB%B6">应用软件</a>与Windows系统最直接的交互方式。大多数<a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E9%A9%B1%E5%8A%A8%E7%A8%8B%E5%BA%8F">驱动程序</a>需要对Windows系统更底层次访问接口，由所用版本的Windows的<a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/Native_API">Native API</a>来提供接口。主要是存放在 C:\WINDOWS\system32</p>
<h3 id="重要dll"><a href="#重要dll" class="headerlink" title="重要dll"></a>重要dll</h3><blockquote>
<p>Kernel32.dll:最核心的功能模块，比如管理内存、进程和线程相关的函数等                </p>
<p>User32.dll:是Windows用户界面相关应用程序接口,如创建窗口和发送消息等</p>
<p>GDI32.dll:全称是Graphical Device Interface(图形设备接口),包含用于画图和显示文本的函数。比如要显示一个程序窗口，就调用了其中的函数来画这个窗口</p>
</blockquote>
<h3 id="Win32-API中的宽字符和多字节字符"><a href="#Win32-API中的宽字符和多字节字符" class="headerlink" title="Win32 API中的宽字符和多字节字符"></a>Win32 API中的宽字符和多字节字符</h3><p>Windows是使用C语言开发的，Win32 API同时支持宽字符与多字节字符                </p>
<p>(1) 字符类型            (2) 字符串指针    </p>
<p>char     CHAR        PSTR(LPSTR) 指向多字节字符串    </p>
<p>wchar_t  WCHAR            PWSTR(LPWSTR) 指向宽字符串    </p>
<p>宏   TCHAR            宏      PTSTR(LPTSTR)</p>
<p>这里重点说一下为什么会有<code>TCHAR</code>这个类型存在，首先f12跟一下<code>TCHAR</code>这个类型</p>
<p><img src="/images/win32/image-20210616233547634.png" alt="image-20210616233547634"></p>
<p>这里可以看到<code>TCHAR</code>是个<code>char</code>类型，但是因为这里使用的是默认的类型，即<code>ascii</code>码，这里如果定义使用<code>unicode</code>编码的话，这里的<code>TCHAR</code>就会是一个<code>wchar</code>类型</p>
<p>假如windows有一个内核函数<code>NTA</code>，windows一般会给两种方法去调用这个内核函数，一个是a版，一个是w版，但是内核使用的都是w版字符。如果使用的是a版字符，在调用之前还会有一个从a版字符到w版字符的转换过程。但是这里已经使用a版习惯了，也不好直接去转换成w版字符。所以这里微软就提出了使用<code>TCHAR</code>，使用起来就更加方便，如果使用<code>ascii</code>码，<code>TCHAR</code>就是<code>char</code>类型，如果使用<code>unicode</code>编码的话，<code>TCHAR</code>就是<code>wchar</code>类型</p>
<h3 id="各种版本的MessageBox"><a href="#各种版本的MessageBox" class="headerlink" title="各种版本的MessageBox"></a>各种版本的MessageBox</h3><p>这里首先定义一个MessageBox探究，f12跟进去查看</p>
<p><img src="/images/win32/image-20210617104655908.png" alt="image-20210617104655908"></p>
<p>这里看到define的<code>MessageBox</code>有两个，一个是<code>MessageBoxW</code>，一个是<code>MessageBoxA</code>，这里就可以印证之前的观点，<code>windows</code>设置了两套字符集，一个是W，一个是A，这里相当于定义了一个<code>MessageBox</code>的宏</p>
<p><img src="/images/win32/image-20210617104924348.png" alt="image-20210617104924348"></p>
<h3 id="win32的入口程序"><a href="#win32的入口程序" class="headerlink" title="win32的入口程序"></a>win32的入口程序</h3><p>生成一个简单的win32程序，定义一个<code>DWORD</code>给<code>hInstance</code>，然后进入反汇编查看x的值</p>
<p><img src="/images/win32/image-20210617112456750.png" alt="image-20210617112456750"></p>
<p>这里可以看到x的值为<code>400000</code>，这里很像<code>ImageBase</code>，为了验证猜想修改一下<code>ImageBase</code>观察值的变化</p>
<p><img src="/images/win32/image-20210617112445040.png" alt="image-20210617112445040"></p>
<p>修改一下<code>ImageBase</code>，这里要十六进制转十进制</p>
<p><img src="/images/win32/image-20210617112832139.png" alt="image-20210617112832139"></p>
<p>再进入反汇编查看x的值已经改变为<code>500000</code></p>
<p><img src="/images/win32/image-20210617112920079.png" alt="image-20210617112920079"></p>
<h3 id="在win32程序中打印信息"><a href="#在win32程序中打印信息" class="headerlink" title="在win32程序中打印信息"></a>在win32程序中打印信息</h3><p>这里首先可以使用<code>OutputDebugString()</code>函数来打印信息，但是这个函数因为也是一个宏，就导致不能够加入参数信息一同进行打印</p>
<p><img src="/images/win32/image-20210617113748486.png" alt="image-20210617113748486"></p>
<p>那么这里就要使用另外一种方法，首先新建一个类</p>
<p><img src="/images/win32/image-20210617113916378.png" alt="image-20210617113916378"></p>
<p>然后在<code>.cpp</code>文件里面存入<code>OutputDebugStringF()</code>这个函数</p>
<p><img src="/images/win32/image-20210617114028142.png" alt="image-20210617114028142"></p>
<p>在<code>.h</code>存入如下代码</p>
<p><img src="/images/win32/image-20210617114154318.png" alt="image-20210617114154318"></p>
<p>包含<code>Tools.h</code>文件</p>
<p><img src="/images/win32/image-20210617114337607.png" alt="image-20210617114337607"></p>
<p>即可打印参数</p>
<p><img src="/images/win32/image-20210617114629498.png" alt="image-20210617114629498"></p>
<h3 id="GetLastError-的使用"><a href="#GetLastError-的使用" class="headerlink" title="GetLastError()的使用"></a>GetLastError()的使用</h3><p>首先还是用<code>MessageBox()</code>实现一个弹窗功能，但是这里修改代码之后并没有出现弹窗，也没有报错，这里就需要用到<code>GetLastError()</code>这个函数</p>
<p><img src="/images/win32/image-20210617161409243.png" alt="image-20210617161409243"></p>
<p>使用<code>GetLastError()</code>打印错误信息，可以看到这里错误序号为578，转换为十进制就是1400</p>
<p><img src="/images/win32/image-20210617162136830.png" alt="image-20210617162136830"></p>
<p>在msdn里找到<code>GetLastError()</code>函数进行查看</p>
<p><img src="/images/win32/image-20210617191945755.png" alt="image-20210617191945755"></p>
<p>找到<code>1400</code>的报错原因</p>
<p><img src="/images/win32/image-20210617193425020.png" alt="image-20210617193425020"></p>
<h1 id="事件-消息-消息处理函数"><a href="#事件-消息-消息处理函数" class="headerlink" title="事件 消息 消息处理函数"></a>事件 消息 消息处理函数</h1><h2 id="事件与消息"><a href="#事件与消息" class="headerlink" title="事件与消息"></a>事件与消息</h2><p>事件：Windows中的事件是一个“动作”，这个动作可能是用户操作应用程序产生的，也可能是Windows自己产生的</p>
<p>消息：用来描述动作，具体描述动作到底做了什么事。例如：这个动作在什么时候产生、哪个应用产生的、在什么位置产生的等等</p>
<p>消息对应的结构体为MSG，具体结构如下</p>
<h3 id="MSG结构"><a href="#MSG结构" class="headerlink" title="MSG结构"></a>MSG结构</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">tagMSG</span> &#123;</span>	</span><br><span class="line">  HWND   hwnd; 	</span><br><span class="line">  UINT   message; 	</span><br><span class="line">  WPARAM wParam; 	</span><br><span class="line">  LPARAM lParam; 	</span><br><span class="line">  DWORD  time; 	</span><br><span class="line">  POINT  pt; 	</span><br><span class="line">&#125; MSG, *PMSG; 	</span><br></pre></td></tr></table></figure>



<blockquote>
<ul>
<li><strong>hwnd</strong> </li>
</ul>
<p>Handle to the window whose window procedure receives the message. </p>
<p>hwnd表示消息所属的窗口，这里可以理解为一个唯一的标识，一个消息一般与某个窗口相关联，在windows中HWND类型变量通常来表示窗口。</p>
</blockquote>
<blockquote>
<ul>
<li><strong>message</strong> </li>
</ul>
<p>Specifies the message identifier. Applications can only use the low word;  the high word is reserved by the system. </p>
<p>windows中消息是由一个数值进行表示的，但是数值不方便记忆，所以windows将消息对应的数值定义为WM_XXX宏（WM == Windows Message） </p>
<p>鼠标左键按下 WM_LBUTTONDOWN 键盘按下 WM_KEYDOWN，message就是消息类型</p>
</blockquote>
<blockquote>
<ul>
<li><strong>wParam</strong> </li>
</ul>
<p>Specifies additional information about the message. The exact meaning  depends on the value of the <strong>message</strong> member. </p>
</blockquote>
<blockquote>
<ul>
<li><strong>lParam</strong> </li>
</ul>
<p>Specifies additional information about the message. The exact meaning  depends on the value of the <strong>message</strong> member. </p>
<p>32位消息的特定附加信息,具体表示什么取决于message </p>
</blockquote>
<blockquote>
<ul>
<li><strong>time</strong> </li>
</ul>
<p>Specifies the time at which the message was posted. </p>
<p>消息创建时的时间 </p>
</blockquote>
<blockquote>
<ul>
<li><strong>pt</strong> </li>
</ul>
<p>Specifies the cursor position, in screen coordinates, when the message was  posted. </p>
<p>记录鼠标所在分辨率的坐标</p>
</blockquote>
<h2 id="系统消息队列与应用消息队列"><a href="#系统消息队列与应用消息队列" class="headerlink" title="系统消息队列与应用消息队列"></a>系统消息队列与应用消息队列</h2><p>当事件传入过后封装为MSG形成消息，因为这时候所有队列都是一起的，这里的结构跟之前C++提到的<code>vector</code>类似，但是这里是先进先出，即不是封闭的。当消息传入之后，windows首先会对这些消息通过hwnd进行分类，以区分不同应用的不同消息。</p>
<p><img src="/images/win32/image-20210617220012819.png" alt="image-20210617220012819"></p>
<p><img src="/images/win32/image-20210617220327317.png" alt="image-20210617220327317"></p>
<p>这里在进行应用消息队列的区分后，windows会从这个队列中取出消息，注意这里应用程序随时会进行更改，所以这里windows做的是一个取消息的循环，即从消息队列中一直取消息出来。再取消息之后，会进行消息的判断，这个判断就是判断消息所进行的操作是不是我这个应用程序所设置的一些操作（例如一个消息框，我在其他空白区域点击的时候都不会进行操作，当我点击发送这个按钮的时候，windows才会执行相应的操作），如果跟应用程序所设置的操作相同，就调用应用程序的相关函数，如果不是的话，就交付给windows进行处理。</p>
<p>这里消息的整个过程可以总结如下；</p>
<blockquote>
<p>事件 -&gt; MSG -&gt; 系统消息队列 -&gt; 应用消息队列 -&gt; 循环取出消息 -&gt;处理消息</p>
</blockquote>
<p><img src="/images/win32/image-20210617221349107.png" alt="image-20210617221349107"></p>
<h2 id="第一个图形界面程序"><a href="#第一个图形界面程序" class="headerlink" title="第一个图形界面程序"></a>第一个图形界面程序</h2><p><code>WNDCLASS</code>用于创建窗口，看一下MSDN的解释</p>
<blockquote>
<p>The <strong>WNDCLASS</strong> structure contains the window class attributes that are  registered by the <a href="winclass_70s3.htm"><strong>RegisterClass</strong></a> function. </p>
</blockquote>
<p>这里说了<code>WNDCLASS</code>这个结构体包含了许多windows里面的类，需要用<code>RegisterClass</code>这个函数进行注册</p>
<p>看一下<code>WNDCLASS</code>这个结构体</p>
<h3 id="WNDCLASS结构"><a href="#WNDCLASS结构" class="headerlink" title="WNDCLASS结构"></a>WNDCLASS结构</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> _<span class="title">WNDCLASS</span> &#123;</span> </span><br><span class="line">    UINT       style; </span><br><span class="line">    WNDPROC    lpfnWndProc; 	<span class="comment">//窗口的消息处理函数</span></span><br><span class="line">    <span class="keyword">int</span>        cbClsExtra; </span><br><span class="line">    <span class="keyword">int</span>        cbWndExtra; </span><br><span class="line">    HINSTANCE  hInstance; 	<span class="comment">//窗口属于的应用程序</span></span><br><span class="line">    HICON      hIcon; 	<span class="comment">//窗口图片标识</span></span><br><span class="line">    HCURSOR    hCursor; 	<span class="comment">//鼠标形状</span></span><br><span class="line">    HBRUSH     hbrBackground; 	<span class="comment">//窗口背景色</span></span><br><span class="line">    LPCTSTR    lpszMenuName; 	<span class="comment">//菜单名字</span></span><br><span class="line">    LPCTSTR    lpszClassName; 	<span class="comment">//结构体名字</span></span><br><span class="line">&#125; WNDCLASS, *PWNDCLASS; </span><br></pre></td></tr></table></figure>



<p>首先定义一下结构体里面的成员，这里其他三个成员都已经定义好，但是这个<code>WindowProc</code>即窗口过程函数有点特殊</p>
<p><img src="/images/win32/image-20210617224028505.png" alt="image-20210617224028505"></p>
<p><code>WindowProc</code>的结构如下</p>
<blockquote>
<p>The <strong>WindowProc</strong> function is an application-defined function that  processes messages sent to a window. The <strong>WNDPROC</strong> type defines a pointer  to this callback function. <strong>WindowProc</strong> is a placeholder for the  application-defined function name. </p>
</blockquote>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">LRESULT CALLBACK <span class="title">WindowProc</span><span class="params">(</span></span></span><br><span class="line"><span class="params"><span class="function">  HWND hwnd,      <span class="comment">// handle to window</span></span></span></span><br><span class="line"><span class="params"><span class="function">  UINT uMsg,      <span class="comment">// message identifier</span></span></span></span><br><span class="line"><span class="params"><span class="function">  WPARAM wParam,  <span class="comment">// first message parameter</span></span></span></span><br><span class="line"><span class="params"><span class="function">  LPARAM lParam   <span class="comment">// second message parameter</span></span></span></span><br><span class="line"><span class="params"><span class="function">)</span></span>;</span><br></pre></td></tr></table></figure>



<p>然后写一个对应结构的<code>WindowProc</code>，代码如下：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line">&#123;  									</span><br><span class="line">	<span class="built_in"><span class="keyword">switch</span></span>(uMsg)								</span><br><span class="line">	&#123;								</span><br><span class="line">		<span class="comment">//窗口消息							</span></span><br><span class="line">	<span class="keyword">case</span> WM_CREATE: 								</span><br><span class="line">		&#123;							</span><br><span class="line">			<span class="built_in">DbgPrintf</span>(<span class="string">&quot;WM_CREATE %d %d\n&quot;</span>,wParam,lParam);						</span><br><span class="line">			CREATESTRUCT* createst = (CREATESTRUCT*)lParam;						</span><br><span class="line">			<span class="built_in">DbgPrintf</span>(<span class="string">&quot;CREATESTRUCT %s\n&quot;</span>,createst-&gt;lpszClass);						</span><br><span class="line">									</span><br><span class="line">			<span class="keyword">return</span> <span class="number">0</span>;						</span><br><span class="line">		&#125;							</span><br><span class="line">	<span class="keyword">case</span> WM_MOVE:								</span><br><span class="line">		&#123;							</span><br><span class="line">			<span class="built_in">DbgPrintf</span>(<span class="string">&quot;WM_MOVE %d %d\n&quot;</span>,wParam,lParam);						</span><br><span class="line">			POINTS points = <span class="built_in">MAKEPOINTS</span>(lParam);						</span><br><span class="line">			<span class="built_in">DbgPrintf</span>(<span class="string">&quot;X Y %d %d\n&quot;</span>,points.x,points.y);						</span><br><span class="line">									</span><br><span class="line">			<span class="keyword">return</span> <span class="number">0</span>;						</span><br><span class="line">		&#125;							</span><br><span class="line">	<span class="keyword">case</span> WM_SIZE:								</span><br><span class="line">		&#123;							</span><br><span class="line">			<span class="built_in">DbgPrintf</span>(<span class="string">&quot;WM_SIZE %d %d\n&quot;</span>,wParam,lParam);						</span><br><span class="line">			<span class="keyword">int</span> newWidth  = (<span class="keyword">int</span>)(<span class="keyword">short</span>) <span class="built_in">LOWORD</span>(lParam);    						</span><br><span class="line">			<span class="keyword">int</span> newHeight  = (<span class="keyword">int</span>)(<span class="keyword">short</span>) <span class="built_in">HIWORD</span>(lParam);   						</span><br><span class="line">			<span class="built_in">DbgPrintf</span>(<span class="string">&quot;WM_SIZE %d %d\n&quot;</span>,newWidth,newHeight);						</span><br><span class="line">									</span><br><span class="line">			<span class="keyword">return</span> <span class="number">0</span>;						</span><br><span class="line">		&#125;							</span><br><span class="line">	<span class="keyword">case</span> WM_DESTROY:								</span><br><span class="line">		&#123;							</span><br><span class="line">			<span class="built_in">DbgPrintf</span>(<span class="string">&quot;WM_DESTROY %d %d\n&quot;</span>,wParam,lParam);						</span><br><span class="line">			<span class="built_in">PostQuitMessage</span>(<span class="number">0</span>);						</span><br><span class="line">									</span><br><span class="line">			<span class="keyword">return</span> <span class="number">0</span>;						</span><br><span class="line">		&#125;							</span><br><span class="line">		<span class="comment">//键盘消息							</span></span><br><span class="line">	<span class="keyword">case</span> WM_KEYUP:								</span><br><span class="line">		&#123;							</span><br><span class="line">			<span class="built_in">DbgPrintf</span>(<span class="string">&quot;WM_KEYUP %d %d\n&quot;</span>,wParam,lParam);						</span><br><span class="line">									</span><br><span class="line">			<span class="keyword">return</span> <span class="number">0</span>;						</span><br><span class="line">		&#125;							</span><br><span class="line">	<span class="keyword">case</span> WM_KEYDOWN:								</span><br><span class="line">		&#123;							</span><br><span class="line">			<span class="built_in">DbgPrintf</span>(<span class="string">&quot;WM_KEYDOWN %d %d\n&quot;</span>,wParam,lParam);						</span><br><span class="line">									</span><br><span class="line">			<span class="keyword">return</span> <span class="number">0</span>;						</span><br><span class="line">		&#125;							</span><br><span class="line">		<span class="comment">//鼠标消息							</span></span><br><span class="line">	<span class="keyword">case</span> WM_LBUTTONDOWN:								</span><br><span class="line">		&#123;							</span><br><span class="line">			<span class="built_in">DbgPrintf</span>(<span class="string">&quot;WM_LBUTTONDOWN %d %d\n&quot;</span>,wParam,lParam);						</span><br><span class="line">			POINTS points = <span class="built_in">MAKEPOINTS</span>(lParam);						</span><br><span class="line">			<span class="built_in">DbgPrintf</span>(<span class="string">&quot;WM_LBUTTONDOWN %d %d\n&quot;</span>,points.x,points.y);						</span><br><span class="line">									</span><br><span class="line">			<span class="keyword">return</span> <span class="number">0</span>;						</span><br><span class="line">		&#125;							</span><br><span class="line">	&#125;								</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">DefWindowProc</span>(hwnd,uMsg,wParam,lParam);								</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>



<p>然后创建窗口，这里注意一下类名，windows系统自带了一些类名，如使用<code>button</code>的话就会生成一个按钮，而我们不想使用windows自带的窗口，所以在这里类名就需要填自己创建的</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 创建窗口  							</span></span><br><span class="line">HWND hwnd = <span class="built_in">CreateWindow</span>(  							</span><br><span class="line">	className,				<span class="comment">//类名		</span></span><br><span class="line">	<span class="built_in">TEXT</span>(<span class="string">&quot;我的第一个窗口&quot;</span>),				<span class="comment">//窗口标题		</span></span><br><span class="line">	WS_OVERLAPPEDWINDOW,				<span class="comment">//窗口外观样式 		</span></span><br><span class="line">	<span class="number">10</span>,				<span class="comment">//相对于父窗口的X坐标		</span></span><br><span class="line">	<span class="number">10</span>,				<span class="comment">//相对于父窗口的Y坐标		</span></span><br><span class="line">	<span class="number">600</span>,				<span class="comment">//窗口的宽度  		</span></span><br><span class="line">	<span class="number">300</span>,				<span class="comment">//窗口的高度  		</span></span><br><span class="line">	<span class="literal">NULL</span>,				<span class="comment">//父窗口句柄，为NULL  		</span></span><br><span class="line">	<span class="literal">NULL</span>,				<span class="comment">//菜单句柄，为NULL  		</span></span><br><span class="line">	hInstance,				<span class="comment">//当前应用程序的句柄  		</span></span><br><span class="line">	<span class="literal">NULL</span>);				<span class="comment">//附加数据一般为NULL		</span></span><br><span class="line">							</span><br><span class="line"><span class="keyword">if</span>(hwnd == <span class="literal">NULL</span>)					<span class="comment">//是否创建成功  		</span></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;  						</span><br></pre></td></tr></table></figure>



<p>这里直接编译运行没有报错但是没有窗口运行起来，回头找一下原因</p>
<p><img src="/images/win32/image-20210618111859266.png" alt="image-20210618111859266"></p>
<p>上面提到过<code>WNDCLASS</code>这个结构体是需要定义很多个成员的，但是并不是每个成员都必须要定义，所以在之前只能定义了几个成员</p>
<p><img src="/images/win32/image-20210618111823935.png" alt="image-20210618111823935"></p>
<p>再往下走到<code>RegisterClass</code>这个函数，到msdn看一下定义</p>
<blockquote>
<p>RegisterClass</p>
<p>The <strong>RegisterClass</strong> function registers a window class for subsequent use  in calls to the <a href="windows_33jr.htm"><strong>CreateWindow</strong></a> or <a href="windows_1w6w.htm"><strong>CreateWindowEx</strong></a> function. </p>
<p><strong>Note</strong> The <strong>RegisterClass</strong> function has been superseded  by the <a href="winclass_0wc8.htm"><strong>RegisterClassEx</strong></a> function. You can  still use <strong>RegisterClass</strong>, however, if you do not need to set the class  small icon. </p>
</blockquote>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">ATOM <span class="title">RegisterClass</span><span class="params">(</span></span></span><br><span class="line"><span class="params"><span class="function">  CONST WNDCLASS *lpWndClass  <span class="comment">// class data</span></span></span></span><br><span class="line"><span class="params"><span class="function">)</span></span>;</span><br></pre></td></tr></table></figure>



<blockquote>
<p>Parameters</p>
<ul>
<li><em>lpWndClass</em> </li>
</ul>
<p>[in] Pointer to a <a href="winclass_8yk2.htm"><strong>WNDCLASS</strong></a> structure.  You must fill the structure with the appropriate class attributes before passing it to the function. </p>
</blockquote>
<p>注意看一下这个下面的定义，<code>You must fill the structure with the appropriate class attributes before passing it to the function. </code>，也就是说无论用不用<code>WNDCLASS</code>这个结构体的成员，都要给成员附上值</p>
<p>那么这里直接给<code>WNDCLASS</code>定义成0即可</p>
<p><img src="/images/win32/image-20210618112720123.png" alt="image-20210618112720123"></p>
<p>这里查看一下<code>WNDCLASS wndclass;</code>和<code>WNDCLASS wndclass = &#123;0&#125;;</code>的区别，<code>WNDCLASS wndclass</code>相当于直接创建了一个结构体<code>wndclass</code>，并没有对结构体中的成员进行任何的操作，所以没有压栈出栈的操作，自然也没有反汇编；而<code>WNDCLASS wndclass = &#123;0&#125;</code>相当于给结构体里面的每个成员都赋初始值为0，所以有反汇编出现</p>
<p><img src="/images/win32/image-20210618114820809.png" alt="image-20210618114820809"></p>
<p><img src="/images/win32/image-20210618114847274.png" alt="image-20210618114847274"></p>
<p>修改之后这里就可以弹出窗口</p>
<p><img src="/images/win32/image-20210618113043584.png" alt="image-20210618113043584"></p>
<p>这里点击缩小、放大、关闭都能够有对应的操作，但是这里我们并没有写这些函数，是因为我们使用了一个windows的回调函数，我们之前在分析的时候提到过一些不是应用程序需要的操作就不会调用应用程序自己的函数，而会交给操作系统去处理，所以这里就必须要返回一个<code>DefWindowsProc()</code>交付给windows处理</p>
<p>另外一个点<code>lpfnWndProc</code>并不是调用了<code>WindowsProc</code>这个函数，而是通过一个指针指向了<code>WindowsProc</code>这个函数，等待着windows调用，这就称为回调函数</p>
<p><img src="/images/win32/image-20210618113141490.png" alt="image-20210618113141490"></p>
<p><img src="/images/win32/image-20210618113245997.png" alt="image-20210618113245997"></p>
<p>这里我们在f5运行程序之后，点击关闭我们生成的这个程序之后，发现程序并没有退出，到任务管理器里面看这个进程还在</p>
<p><img src="/images/win32/image-20210618113708302.png" alt="image-20210618113708302"></p>
<p>每一个消息都有一个对应的编号，来到回调函数f12跟进去查看</p>
<p><img src="/images/win32/image-20210618114312461.png" alt="image-20210618114312461"></p>
<h2 id="windows消息范围说明"><a href="#windows消息范围说明" class="headerlink" title="windows消息范围说明"></a>windows消息范围说明</h2><p>0 ～ WM_USER – 1系统消息</p>
<p>WM_USER ～ 0x7FFF自定义窗口类整数消息</p>
<p>WM_APP ～ 0xBFFF应用程序自定义消息</p>
<p>0xC000 ～ 0xFFFF应用程序字符串消息</p>
<p>&gt; 0xFFFF以后 系统应用保留</p>
<h2 id="WindowProc结构探究"><a href="#WindowProc结构探究" class="headerlink" title="WindowProc结构探究"></a>WindowProc结构探究</h2><p>我们知道<code>WindowProc</code>的结构如下所示</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">LRESULT CALLBACK <span class="title">WindowProc</span><span class="params">(</span></span></span><br><span class="line"><span class="params"><span class="function">  HWND hwnd,       <span class="comment">// handle to window</span></span></span></span><br><span class="line"><span class="params"><span class="function">  UINT uMsg,       <span class="comment">// WM_CREATE</span></span></span></span><br><span class="line"><span class="params"><span class="function">  WPARAM wParam,   <span class="comment">// not used</span></span></span></span><br><span class="line"><span class="params"><span class="function">  LPARAM lParam    <span class="comment">// creation data (LPCREATESTRUCT)</span></span></span></span><br><span class="line"><span class="params"><span class="function">)</span></span>;</span><br></pre></td></tr></table></figure>



<p>探究以下<code>WM_CREATE</code>函数中<code>wParam</code>和<code>lParam</code>的用法</p>
<blockquote>
<ul>
<li><p><em>wParam</em> </p>
<p>This parameter is not used. </p>
</li>
<li><p><em>lParam</em> </p>
<p>Pointer to a <a href="windows_06lu.htm"><strong>CREATESTRUCT</strong></a> structure  that contains information about the window being created. </p>
</li>
</ul>
</blockquote>
<p>这里可以看到<code>wParam</code>这个参数是不使用的，<code>lParam</code>这个参数指向的是一个结构体<code>CREATESTRUCT</code>，这里继续探究<code>CREATESTRUCT</code>这个结构体</p>
<p>创建一个结构体指针看一下结构体里面有哪些成员</p>
<p><img src="/images/win32/image-20210619125144253.png" alt="image-20210619125144253"></p>
<p>打印一下<code>lpszclass</code>看一下</p>
<p><img src="/images/win32/image-20210619125301285.png" alt="image-20210619125301285"></p>
<p>再探究一个函数<code>WM_MOVE</code>，首先打印它的id，可以看到这里id为3</p>
<p><img src="/images/win32/image-20210619125554262.png" alt="image-20210619125554262"></p>
<p><img src="/images/win32/image-20210619125602231.png" alt="image-20210619125602231"></p>
<p>继续msdn查看<code>WM_MOVE</code>的结构中的<code>wParam</code>和<code>lParam</code></p>
<blockquote>
<ul>
<li><em>wParam</em> </li>
</ul>
<p>This parameter is not used. </p>
<ul>
<li><em>lParam</em> </li>
</ul>
<p>Specifies the x and y coordinates of the upper-left corner of the client  area of the window. The low-order word contains the x-coordinate while the  high-order word contains the y coordinate. </p>
</blockquote>
<p>这里同样<code>wParam</code>是不使用的，<code>lParam</code>表示窗口的坐标，并且低位表示x坐标，高位表示y坐标</p>
<p>这里看到msdn已经给我们给出了使用的方法，这里直接调用一下</p>
<p><img src="/images/win32/image-20210619132100707.png" alt="image-20210619132100707"></p>
<p>写一个输出函数</p>
<p><img src="/images/win32/image-20210619132527542.png" alt="image-20210619132527542"></p>
<p><img src="/images/win32/image-20210619132231065.png" alt="image-20210619132231065"></p>
<p>继续探究<code>WM_SIZE</code>，这里跟之前不一样的是<code>wParam</code>在<code>WM_SIZE</code>里面是有意义的，这里先不细说，还是先看<code>lParam</code>属性</p>
<p><img src="/images/win32/image-20210619150650432.png" alt="image-20210619150650432"></p>
<blockquote>
<ul>
<li><p><em>lParam</em> </p>
<p>The low-order word of <em>lParam</em> specifies the new width of the client  area.  </p>
<p>The high-order word of <em>lParam</em> specifies the new height of the client  area. </p>
</li>
</ul>
</blockquote>
<p>还是熟悉的配方，只不过这里是低位为宽，高位为高，打印一下<code>wParam</code>和<code>lParam</code>属性</p>
<p><img src="/images/win32/image-20210619152434258.png" alt="image-20210619152434258"></p>
<p><img src="/images/win32/image-20210619152106892.png" alt="image-20210619152106892"></p>
<p>这里发现<code>wParam</code>属性始终为0，这里回到定义的地方看一下，当窗口最大化、最小化操作时这个值才会变化</p>
<p><img src="/images/win32/image-20210619152330928.png" alt="image-20210619152330928"></p>
<p>这里再分别把<code>lParam</code>属性的低位和高位分别打印出来如下图所示</p>
<p><img src="/images/win32/image-20210619152619778.png" alt="image-20210619152619778"></p>
<p><img src="/images/win32/image-20210619152612517.png" alt="image-20210619152612517"></p>
<h1 id="ESP寻址-定位回调函数"><a href="#ESP寻址-定位回调函数" class="headerlink" title="ESP寻址 定位回调函数"></a>ESP寻址 定位回调函数</h1><h2 id="关于入口函数的探究"><a href="#关于入口函数的探究" class="headerlink" title="关于入口函数的探究"></a>关于入口函数的探究</h2><h3 id="WinMain结构"><a href="#WinMain结构" class="headerlink" title="WinMain结构"></a>WinMain结构</h3><p>WinMain函数主要包含了以下几个成员</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> WINAPI <span class="title">WinMain</span><span class="params">(</span></span></span><br><span class="line"><span class="params"><span class="function">  HINSTANCE hInstance,      <span class="comment">// handle to current instance</span></span></span></span><br><span class="line"><span class="params"><span class="function">  HINSTANCE hPrevInstance,  <span class="comment">// handle to previous instance</span></span></span></span><br><span class="line"><span class="params"><span class="function">  LPSTR lpCmdLine,          <span class="comment">// command line</span></span></span></span><br><span class="line"><span class="params"><span class="function">  <span class="keyword">int</span> nCmdShow              <span class="comment">// show state</span></span></span></span><br><span class="line"><span class="params"><span class="function">)</span></span>;</span><br></pre></td></tr></table></figure>



<blockquote>
<ul>
<li><p><em>hInstance</em> </p>
<p>[in] Handle to the current instance of the application. </p>
</li>
<li><p><em>hPrevInstance</em> </p>
<p>[in] Handle to the previous instance of the application. This parameter is  always NULL.</p>
</li>
<li><p><em>lpCmdLine</em> </p>
<p>[in] Pointer to a null-terminated string specifying the command line for the  application, excluding the program name. To retrieve the entire command line,  use the <a href="javascript:hhobj_3.Click()"><strong>GetCommandLine</strong></a> function.</p>
</li>
<li><p><em>nCmdShow</em> </p>
<p>is a flag that says whether the main application window will be minimized, maximized, or shown normally.</p>
</li>
</ul>
</blockquote>
<p><code>hInstance</code>被称为实例句柄，当它被加载到内存时，操作系统会根据这个值来识别可执行文件。<code>hPrevInstance </code>本来在16位windows中使用，现在已经废弃，一直为空。<code>IpCmdLine</code>包含作为<code>Unicode</code>字符串的命令行参数。<code>nCmdShow</code>表示主应用程序窗口是最大化、最小化还是正常显示。</p>
<p>这里说下<code>IpCmdLine</code>的具体作用，当我们打开cmd使用程序执行命令的时候在后面执行的命令就是通过这个<code>IpCmdLine</code>传入</p>
<p>编译生成exe拿到win10中用<code>DebugView</code>进行运行查看</p>
<p><img src="/images/win32/image-20210619155718107.png" alt="image-20210619155718107"> </p>
<p><img src="/images/win32/image-20210619155911660.png" alt="image-20210619155911660"></p>
<h2 id="win32应用程序入口识别"><a href="#win32应用程序入口识别" class="headerlink" title="win32应用程序入口识别"></a>win32应用程序入口识别</h2><p>这里首先改成release版本编译</p>
<p><img src="/images/win32/image-20210619160259786.png" alt="image-20210619160259786"></p>
<p>拖入od，这里并不是我们写的入口程序的地址</p>
<p><img src="/images/win32/image-20210619160504252.png" alt="image-20210619160504252"></p>
<p>在<code>WinMain</code>执行之前下断点查看堆栈，发现调用<code>WinMain()</code>的是<code>WinMainCRTStartup()</code>这个函数</p>
<p><img src="/images/win32/image-20210619160837419.png" alt="image-20210619160837419"> </p>
<p>od往下跟，找到<code>GetModuleHandleA</code>这个函数</p>
<p><img src="/images/win32/image-20210619161810808.png" alt="image-20210619161810808"></p>
<h3 id="GetModuleHandleA"><a href="#GetModuleHandleA" class="headerlink" title="GetModuleHandleA"></a>GetModuleHandleA</h3><p>看一下MSDN里对<code>GetModuleHandleA</code>的描述</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">HMODULE <span class="title">GetModuleHandleA</span><span class="params">(</span></span></span><br><span class="line"><span class="params"><span class="function">  LPCSTR lpModuleName</span></span></span><br><span class="line"><span class="params"><span class="function">)</span></span>;</span><br></pre></td></tr></table></figure>



<blockquote>
<p>The name of the loaded module (either a .dll or .exe file). If the file name extension is omitted, the default library extension .dll is appended. The file name string can include a trailing point character (.) to indicate that the module name has no extension. The string does not have to specify a path. When specifying a path, be sure to use backslashes (), not forward slashes (/). The name is compared (case independently) to the names of modules currently mapped into the address space of the calling process.</p>
<p>If this parameter is NULL, <strong>GetModuleHandle</strong> returns a handle to the file used to create the calling process (.exe file).</p>
<p>The <strong>GetModuleHandle</strong> function does not retrieve handles for modules that were loaded using the <strong>LOAD_LIBRARY_AS_DATAFILE</strong> flag. For more information, see <a target="_blank" rel="noopener" href="https://docs.microsoft.com/en-us/windows/desktop/api/libloaderapi/nf-libloaderapi-loadlibraryexa">LoadLibraryEx</a>.</p>
</blockquote>
<p>此函数用来加载模块的名称，如果参数为NULL，则返回exe的句柄</p>
<p>继续跟这个函数，这里的<code>GetModuleHandleA</code>用的是间接call，指向一个地址</p>
<p><img src="/images/win32/image-20210619162327715.png" alt="image-20210619162327715"></p>
<p><img src="/images/win32/image-20210619162351805.png" alt="image-20210619162351805"></p>
<p>这里跟到这个地址，发现这里又指向一个地址，地址里面存储的是<code>KERNEL32</code>这个dll的<code>GetModuleHandleA</code>这个函数</p>
<p><img src="/images/win32/image-20210619162442174.png" alt="image-20210619162442174"></p>
<p>这里点击回车跟进这个函数查看</p>
<p><img src="/images/win32/image-20210619163533117.png" alt="image-20210619163533117"></p>
<p>这里发现<code>retn 10</code>，也就是4个参数，那么几乎可以确定这个函数就是我们要找的入口函数</p>
<p><img src="/images/win32/image-20210619163603546.png" alt="image-20210619163603546"></p>
<p>这里往上看一个细节，这里首先把内存的值传给了ecx，再把ecx的值压入堆栈，那么这里肯定就不是寄存器传参。一般使用寄存器传参的不会有从内存赋值给ecx的操作</p>
<p><img src="/images/win32/image-20210619164220495.png" alt="image-20210619164220495"></p>
<h2 id="ESP寻址"><a href="#ESP寻址" class="headerlink" title="ESP寻址"></a>ESP寻址</h2><p>F2断点到函数位置</p>
<p><img src="/images/win32/image-20210619164707475.png" alt="image-20210619164707475"></p>
<p>查看堆栈里面的值，发现有四个参数，因为压栈顺序为<code>_stdcall</code>内平栈，从右往左入栈，那么第一个参数就是<code>hInstance</code>即<code>ImageBase</code>，第二个参数为<code>hPrevInstance</code>永远为NULL，第三个参数为<code>IpCmdLine</code>为命令行参数，第四个参数为<code>nCmdShow</code>为最大最小化还是正常显示</p>
<p>这里的<code>0019FEE4</code>里面存的就是函数调用完成后返回的地址，即<code>00401783</code></p>
<p><img src="/images/win32/image-20210619164726395.png" alt="image-20210619164726395"></p>
<p>这里注意一下，之前提升堆栈都是通过<code>push ebp    </code>，<code>mov ebp,esp</code>提升堆栈，但是在<code>release</code>版本中可能使用的是esp寻址，直接使用<code>sub esp,0x98</code>提升堆栈而<code>ebp</code>不变</p>
<p>这里提升堆栈过后，<code>esp+0x98</code>的地址存的就是函数的返回地址，如果要找第一个参数就是<code>esp+0x9C</code></p>
<p><img src="/images/win32/image-20210619165504266.png" alt="image-20210619165504266"></p>
<p>所以如果使用esp寻址的话，esp的值是随时要变化的，所以在堆栈寻址的时候要时刻注意esp的变化</p>
<h2 id="窗口回调函数的定位"><a href="#窗口回调函数的定位" class="headerlink" title="窗口回调函数的定位"></a>窗口回调函数的定位</h2><p>首先是窗口回调函数的结构</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wndclass.lpfnWndProc = WindowProc;	</span><br></pre></td></tr></table></figure>



<p>而<code>wndclass</code>是通过<code>RegisterClass</code>注册进去的，那么我们继续在od里面跟到<code>RegisterClass</code>这个函数，在push参数前面下一个断点</p>
<p><img src="/images/win32/image-20210619175031985.png" alt="image-20210619175031985"></p>
<p>F8单步跟下去，得到eax的值为<code>0019FEC0</code>，这个地址就是我们要找的结构</p>
<p><img src="/images/win32/image-20210619175210746.png" alt="image-20210619175210746"></p>
<p>点击右键在堆栈窗口中跟随，这里可以看到堆栈窗口中是有10个值</p>
<p><img src="/images/win32/image-20210619175228503.png" alt="image-20210619175228503"></p>
<p>在<code>WNDCLASS</code>中，第二个成员<code>lpfnWndProc</code>就是我们找的回调函数，地址为<code>004010F0</code></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> _<span class="title">WNDCLASS</span> &#123;</span> </span><br><span class="line">    UINT       style; </span><br><span class="line">    WNDPROC    lpfnWndProc; </span><br><span class="line">    <span class="keyword">int</span>        cbClsExtra; </span><br><span class="line">    <span class="keyword">int</span>        cbWndExtra; </span><br><span class="line">    HINSTANCE  hInstance; </span><br><span class="line">    HICON      hIcon; </span><br><span class="line">    HCURSOR    hCursor; </span><br><span class="line">    HBRUSH     hbrBackground; </span><br><span class="line">    LPCTSTR    lpszMenuName; </span><br><span class="line">    LPCTSTR    lpszClassName; </span><br><span class="line">&#125; WNDCLASS, *PWNDCLASS; </span><br></pre></td></tr></table></figure>



<p><img src="/images/win32/image-20210619175255745.png" alt="image-20210619175255745"></p>
<h2 id="具体事件处理的定位"><a href="#具体事件处理的定位" class="headerlink" title="具体事件处理的定位"></a>具体事件处理的定位</h2><p>这里继续往下找，比如我要弄清楚一个函数的具体功能，这里就以<code>WM_LBUTTONDOWN</code>为例</p>
<p><img src="/images/win32/image-20210619174334794.png" alt="image-20210619174334794"></p>
<p><code>WM_LBUTTONDOWN</code>对应的编号为<code>0x0201</code></p>
<p><img src="/images/win32/image-20210619180135244.png" alt="image-20210619180135244"></p>
<p>在回调函数的地方下个断点，这里的<code>[esp+0x8]</code>就是消息的类型</p>
<p><img src="/images/win32/image-20210619175417743.png" alt="image-20210619175417743"></p>
<p>加一个条件为消息类型是<code>WM_LBUTTONDOWN</code></p>
<p><img src="/images/win32/image-20210619175403377.png" alt="image-20210619175403377"></p>
<p>运行一下，当我点击右键的时候程序还是会照常运行</p>
<p><img src="/images/win32/image-20210619175815807.png" alt="image-20210619175815807"></p>
<p>当我点击左键的时候它暂停了</p>
<p><img src="/images/win32/image-20210619175840948.png" alt="image-20210619175840948"></p>
<p>F8单步往下跟就可以找到鼠标左键按钮处理的函数</p>
<p><img src="/images/win32/image-20210619175932395.png" alt="image-20210619175932395"></p>
<h1 id="子窗口-消息处理函数"><a href="#子窗口-消息处理函数" class="headerlink" title="子窗口 消息处理函数"></a>子窗口 消息处理函数</h1><h2 id="在窗口中创建按钮"><a href="#在窗口中创建按钮" class="headerlink" title="在窗口中创建按钮"></a>在窗口中创建按钮</h2><p>添加如下代码</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">CreateButton</span><span class="params">(HWND hwnd)</span>		</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	HWND hwndPushButton;</span><br><span class="line">	hwndPushButton = <span class="built_in">CreateWindow</span> ( 							</span><br><span class="line">	<span class="built_in">TEXT</span>(<span class="string">&quot;button&quot;</span>), 						</span><br><span class="line">	<span class="built_in">TEXT</span>(<span class="string">&quot;普通按钮&quot;</span>),						</span><br><span class="line">	<span class="comment">//WS_CHILD | WS_VISIBLE | BS_PUSHBUTTON | BS_DEFPUSHBUTTON,						</span></span><br><span class="line">	WS_CHILD | WS_VISIBLE | BS_PUSHBUTTON | BS_DEFPUSHBUTTON,						</span><br><span class="line">	<span class="number">10</span>, <span class="number">10</span>,						</span><br><span class="line">	<span class="number">80</span>, <span class="number">20</span>,						</span><br><span class="line">	hwnd, 		<span class="comment">//父窗口句柄 				</span></span><br><span class="line">	(HMENU)<span class="number">1001</span>,		<span class="comment">//子窗口ID				</span></span><br><span class="line">	hAppInstance, 						</span><br><span class="line">	<span class="literal">NULL</span>);						</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>这里的<code>hAppInstance</code>本来为当前应用程序的句柄，这里把<code>hAppInstance</code>定义为全局变量，即<code>HINSTANCE hAppInstance;</code>。还有一个要注意的点是<code>button</code></p>
<p>不能够独立存在，所以这里需要用父窗口的句柄，而且这个函数需要在窗口创建出来之后才能使用，所以这里要放在创建窗口的后面</p>
<p><img src="/images/win32/image-20210620163232033.png" alt="image-20210620163232033"></p>
<p><img src="/images/win32/image-20210620163251191.png" alt="image-20210620163251191"></p>
<p>这里探究一下<code>WS_CHILD | WS_VISIBLE | BS_PUSHBUTTON | BS_DEFPUSHBUTTON</code>这几个参数</p>
<blockquote>
<p><strong>WS_CHILD</strong>  Creates a child window. Cannot be used with the  <strong>WS_POPUP</strong> style.</p>
<p><strong>WS_VISIBLE</strong>  Creates a window that is initially visible.</p>
<p><strong>BS_PUSHBUTTON</strong>  Creates a pushbutton that posts a <strong>WM_COMMAND</strong>  message to the owner window when the user selects the button.</p>
<p><strong>BS_DEFPUSHBUTTON</strong>  Creates a button that has a heavy black border. The  user can select this button by pressing the ENTER key. This style enables the  user to quickly select the most likely option (the default option).</p>
</blockquote>
<h2 id="按钮事件的处理"><a href="#按钮事件的处理" class="headerlink" title="按钮事件的处理"></a>按钮事件的处理</h2><p>在自己创建窗口的时候第一行应该定义一个类，但是在创建button的时候这里直接就可以使用。是因为系统已经定义好了常用的一些窗口函数</p>
<p><img src="/images/win32/image-20210620165019695.png" alt="image-20210620165019695"></p>
<p>这里我们想看一下button究竟是怎样定义的<code>WNDCLASS</code>，这里调用<code>GetClassName</code>函数找到类名存到<code>szBuffer</code>分配的缓冲区里</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">TCHAR szBuffer[<span class="number">0x20</span>];				</span><br><span class="line"><span class="built_in">GetClassName</span>(hwndPushButton,szBuffer,<span class="number">0x20</span>);	</span><br></pre></td></tr></table></figure>



<h3 id="GetClassName"><a href="#GetClassName" class="headerlink" title="GetClassName"></a>GetClassName</h3><p>这里看一下<code>GetClassName()</code>这个函数</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">GetClassName</span><span class="params">(</span></span></span><br><span class="line"><span class="params"><span class="function">  HWND hWnd,           <span class="comment">// handle to window</span></span></span></span><br><span class="line"><span class="params"><span class="function">  LPTSTR lpClassName,  <span class="comment">// class name</span></span></span></span><br><span class="line"><span class="params"><span class="function">  <span class="keyword">int</span> nMaxCount        <span class="comment">// size of class name buffer</span></span></span></span><br><span class="line"><span class="params"><span class="function">)</span></span>;</span><br></pre></td></tr></table></figure>



<blockquote>
<ul>
<li><em>hWnd</em> </li>
</ul>
<p> [in] Handle to the window and, indirectly, the class to which the window  belongs. </p>
<ul>
<li><em>lpClassName</em> </li>
</ul>
<p> [out] Pointer to the buffer that is to receive the class name string. </p>
<ul>
<li><em>nMaxCount</em> </li>
</ul>
<p> [in] Specifies the length, in <strong>TCHARs</strong>, of the buffer pointed to by the  <em>lpClassName</em> parameter. The class name string is truncated if it is longer  than the buffer. </p>
</blockquote>
<p><code>lpClassName</code>为out参数，指向缓冲区地址（即存放类函数），<code>nMaxCount</code>是给缓冲区分配的空间大小</p>
<p>然后查看具体信息</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">WNDCLASS wc;				</span><br><span class="line"><span class="built_in">GetClassInfo</span>(hAppInstance,szBuffer,&amp;wc);				</span><br><span class="line"><span class="built_in">OutputDebugStringF</span>(<span class="string">&quot;--&gt;%s\n&quot;</span>,wc.lpszClassName);				</span><br><span class="line"><span class="built_in">OutputDebugStringF</span>(<span class="string">&quot;--&gt;%x\n&quot;</span>,wc.lpfnWndProc);				</span><br></pre></td></tr></table></figure>



<h3 id="GetClassInfo"><a href="#GetClassInfo" class="headerlink" title="GetClassInfo"></a>GetClassInfo</h3><p>这里又用到一个api函数<code>GetClassInfo()</code></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">BOOL <span class="title">GetClassInfo</span><span class="params">(</span></span></span><br><span class="line"><span class="params"><span class="function">  HINSTANCE hInstance,    <span class="comment">// handle to application instance</span></span></span></span><br><span class="line"><span class="params"><span class="function">  LPCTSTR lpClassName,    <span class="comment">// class name</span></span></span></span><br><span class="line"><span class="params"><span class="function">  LPWNDCLASS lpWndClass   <span class="comment">// class data</span></span></span></span><br><span class="line"><span class="params"><span class="function">)</span></span>;</span><br></pre></td></tr></table></figure>



<blockquote>
<ul>
<li><p><em>hInstance</em> </p>
<p>[in] Handle to the instance of the application that created the class. To  retrieve information about classes defined by the system (such as buttons or  list boxes), set this parameter to NULL. </p>
</li>
<li><p><em>lpClassName</em> </p>
<p>[in] Pointer to a null-terminated string containing the class name. The name  must be that of a preregistered class or a class registered by a previous call  to the <a href="winclass_70s3.htm"><strong>RegisterClass</strong></a> or <a href="winclass_0wc8.htm"><strong>RegisterClassEx</strong></a> function.  Alternatively, this parameter can be an atom. If so, it must be a class atom  created by a previous call to <strong>RegisterClass</strong> or <strong>RegisterClassEx</strong>.  The atom must be in the low-order word of <em>lpClassName</em>; the high-order  word must be zero. </p>
</li>
<li><p><em>lpWndClass</em> </p>
<p>[out] Pointer to a <a href="winclass_8yk2.htm"><strong>WNDCLASS</strong></a> structure  that receives the information about the class. </p>
</li>
</ul>
</blockquote>
<p><code>hInstance</code>是函数的<code>ImageBase</code>，<code>lpClassName</code>是前面得到的缓冲区，<code>lpWndClass</code>为out参数，将结构的信息写到<code>lpWndClass</code>所在的地址</p>
<p>然后再使用<code>wc</code>这个结构体打印信息，这里使用<code>lpszClassName</code>和<code>lpfnWndProc</code>打印地址</p>
<p><img src="/images/win32/image-20210620171245819.png" alt="image-20210620171245819"></p>
<p>继续往下探究，这里当我不点击这几个按钮所在的区域的时候，会产生消息，但是当我点击这几个按钮的时候是不会显示消息的，这里不会显示不代表没有产生消息，只是这里因为这几个按钮是子窗口，所以这里的消息不会在父窗口里的消息函数中直接输出显示</p>
<p><img src="/images/win32/image-20210620172152989.png" alt="image-20210620172152989"></p>
<p>当按钮有事件产生时，会给父窗口消息处理程序发送一个<code>WM_COMMAND</code>消息，我们就需要增加一个<code>WM_COMMAND</code>函数</p>
<p>也就是说在子窗口调用<code>WinProc</code>的时候需要用<code>WM_COMMAND</code>去调用父窗口的<code>WinProc</code></p>
<p><img src="/images/win32/image-20210620172504902.png" alt="image-20210620172504902"></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">case</span> WM_COMMAND:								</span><br><span class="line">&#123;								</span><br><span class="line">	<span class="built_in"><span class="keyword">switch</span></span>(<span class="built_in">LOWORD</span>(wParam))							</span><br><span class="line">	&#123;							</span><br><span class="line">		<span class="keyword">case</span> <span class="number">1001</span>:						</span><br><span class="line">			<span class="built_in">MessageBox</span>(hwnd,<span class="string">&quot;Hello Button 1&quot;</span>,<span class="string">&quot;Demo&quot;</span>,MB_OK);					</span><br><span class="line">			<span class="keyword">return</span> <span class="number">0</span>;					</span><br><span class="line">		<span class="keyword">case</span> <span class="number">1002</span>:						</span><br><span class="line">			<span class="built_in">MessageBox</span>(hwnd,<span class="string">&quot;Hello Button 2&quot;</span>,<span class="string">&quot;Demo&quot;</span>,MB_OK);					</span><br><span class="line">			<span class="keyword">return</span> <span class="number">0</span>;					</span><br><span class="line">		<span class="keyword">case</span> <span class="number">1003</span>:						</span><br><span class="line">			<span class="built_in">MessageBox</span>(hwnd,<span class="string">&quot;Hello Button 3&quot;</span>,<span class="string">&quot;Demo&quot;</span>,MB_OK);					</span><br><span class="line">			<span class="keyword">return</span> <span class="number">0</span>;					</span><br><span class="line">	&#125;							</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">DefWindowProc</span>(hwnd,uMsg,wParam,lParam);							</span><br><span class="line">&#125;								</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p><img src="/images/win32/image-20210620202158326.png" alt="image-20210620202158326"></p>
<h2 id="消息堆栈"><a href="#消息堆栈" class="headerlink" title="消息堆栈"></a>消息堆栈</h2><p>F7生成release版本进行调试，找到回调函数地址为<code>00401260</code></p>
<p><img src="/images/win32/image-20210620205445014.png" alt="image-20210620205445014"></p>
<p>在<code>401260</code>处下断点，这里返回的为消息类型</p>
<p><img src="/images/win32/image-20210620205831080.png" alt="image-20210620205831080"></p>
<p>我们看一下<code>WM_COMMAND</code>的<code>WindowProc</code>的结构如下所示</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">LRESULT CALLBACK <span class="title">WindowProc</span><span class="params">(</span></span></span><br><span class="line"><span class="params"><span class="function">  HWND hwnd,       <span class="comment">// handle to window</span></span></span></span><br><span class="line"><span class="params"><span class="function">  WM_COMMAND,      <span class="comment">// the message to send</span></span></span></span><br><span class="line"><span class="params"><span class="function">  WPARAM wParam,   <span class="comment">// notification code and identifier</span></span></span></span><br><span class="line"><span class="params"><span class="function">  LPARAM lParam    <span class="comment">// handle to control (HWND)</span></span></span></span><br><span class="line"><span class="params"><span class="function">)</span></span>;</span><br></pre></td></tr></table></figure>



<blockquote>
<ul>
<li><p><em>wParam</em> </p>
<p>The high-order word specifies the notification code if the message is from a  control. If the message is from an accelerator, this value is 1. If the message  is from a menu, this value is zero.  The low-order word specifies the identifier of the menu item, control, or  accelerator. </p>
</li>
<li><p><em>lParam</em> </p>
<p>Handle to the control sending the message if the message is from a control.  Otherwise, this parameter is NULL. </p>
</li>
</ul>
</blockquote>
<p>回调函数的堆栈如图所示，我们是通过地址跳转到<code>401260</code>这个地址，那么esp还是在<code>WindowProC</code>结构处不变，所以<code>esp+0x8</code>就是指向的<code>uMsg</code>的值，即消息类型</p>
<p><img src="/images/win32/image-20210620210029004.png" alt="image-20210620210029004"></p>
<h2 id="按钮事件处理逻辑定位"><a href="#按钮事件处理逻辑定位" class="headerlink" title="按钮事件处理逻辑定位"></a>按钮事件处理逻辑定位</h2><p>这里再去找<code>WM_COMMAND</code>这个消息类型</p>
<p><img src="/images/win32/image-20210620210545289.png" alt="image-20210620210545289"></p>
<p>这里我点击父窗口的时候是没有反应的</p>
<p><img src="/images/win32/image-20210620210735200.png" alt="image-20210620210735200"></p>
<p>当我点击子窗口的时候发现已经暂停</p>
<p><img src="/images/win32/image-20210620210803068.png" alt="image-20210620210803068"></p>
<p>再运行一下，有了弹窗</p>
<p><img src="/images/win32/image-20210620210847654.png" alt="image-20210620210847654"></p>
<p>这里就有一个问题，当我们点击每一个按钮的时候都会触发断点，所以我们需要想一个方法来断指定的按钮，这里就需要用到<code>wParam</code></p>
<p>例如我只想断复选框，这里找到十六进制情况下的ID为<code>000003EA</code></p>
<p><img src="/images/win32/image-20210620211241714.png" alt="image-20210620211241714"></p>
<p>再添加条件</p>
<p><img src="/images/win32/image-20210620211411587.png" alt="image-20210620211411587"></p>
<p>当我点普通按钮的时候是不断的</p>
<p><img src="/images/win32/image-20210620211614399.png" alt="image-20210620211614399"></p>
<p>当我点击复选框之后就暂停了</p>
<p><img src="/images/win32/image-20210620211648507.png" alt="image-20210620211648507"></p>
<h1 id="资源文件-消息断点"><a href="#资源文件-消息断点" class="headerlink" title="资源文件 消息断点"></a>资源文件 消息断点</h1><h2 id="用资源文件创建对话框"><a href="#用资源文件创建对话框" class="headerlink" title="用资源文件创建对话框"></a>用资源文件创建对话框</h2><p>首先创建一个资源文件</p>
<p><img src="/images/win32/image-20210620230508428.png" alt="image-20210620230508428"></p>
<p>手动添加<code>resource.h</code>头文件</p>
<p><img src="/images/win32/image-20210620230539325.png" alt="image-20210620230539325"></p>
<p>右键在rc文件处加入Dialog并点击新建</p>
<p><img src="/images/win32/image-20210620230655585.png" alt="image-20210620230655585"></p>
<p>可以看到创建成功</p>
<p><img src="/images/win32/image-20210620230748904.png" alt="image-20210620230748904"></p>
<p>右键修改对话框的属性</p>
<p><img src="/images/win32/image-20210620231102040.png" alt="image-20210620231102040"></p>
<p>F7编译后会在<code>resource.h</code>头文件中定义一个dialog</p>
<p><img src="/images/win32/image-20210620231237414.png" alt="image-20210620231237414"></p>
<p>然后就可以用<code>DialogBox()</code>生成dialog</p>
<h3 id="GetProcAddress"><a href="#GetProcAddress" class="headerlink" title="GetProcAddress"></a>GetProcAddress</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">FARPROC <span class="title">GetProcAddress</span><span class="params">(</span></span></span><br><span class="line"><span class="params"><span class="function">  HMODULE hModule,    <span class="comment">// handle to DLL module</span></span></span></span><br><span class="line"><span class="params"><span class="function">  LPCSTR lpProcName   <span class="comment">// function name</span></span></span></span><br><span class="line"><span class="params"><span class="function">)</span></span>;</span><br></pre></td></tr></table></figure>



<blockquote>
<ul>
<li><p><em>hModule</em> </p>
<p>[in] Handle to the DLL module that contains the function or variable. The <a href="dll_1o8p.htm"><strong>LoadLibrary</strong></a> or <a href="dll_5plx.htm"><strong>GetModuleHandle</strong></a> function returns this handle. </p>
</li>
<li><p><em>lpProcName</em> </p>
<p>[in] Pointer to a null-terminated string containing the function or variable  name, or the function’s ordinal value. If this parameter is an ordinal value, it  must be in the low-order word; the high-order word must be zero. </p>
</li>
</ul>
</blockquote>
<p><code>GetProcAddress</code>的作用是通过<code>hModule</code>到导出表里找到dll，然后通过名字得到dll地址</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">char</span> szDllBuffer = <span class="string">&quot;kernel32.dll&quot;</span>;</span><br><span class="line"><span class="keyword">char</span> szFunctionName = <span class="string">&quot;Function&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">GetProcAddress</span>(szDllBuffer,szFunctionName);</span><br></pre></td></tr></table></figure>



<p>但是我们知道在导入表里有两种导入方式，一是名称导入，二是序号导入，那么如果是序号导入的情况下我们就需要把序号强转为<code>char*</code>类型后再去查询，即用指针去查询</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">char</span> szDllBuffer = <span class="string">&quot;kernel32.dll&quot;</span>;</span><br><span class="line"><span class="keyword">char</span> szFunctionName = <span class="string">&quot;Function&quot;</span>; <span class="comment">//序号为11</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">GetProcAddress</span>(szDllBuffer,(<span class="keyword">char</span>*)<span class="number">11</span>);</span><br></pre></td></tr></table></figure>





<h3 id="Dialogbox"><a href="#Dialogbox" class="headerlink" title="Dialogbox"></a>Dialogbox</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">INT_PTR DialogBox(</span><br><span class="line">  HINSTANCE hInstance,  // handle to module</span><br><span class="line">  LPCTSTR lpTemplate,   // dialog box template</span><br><span class="line">  HWND hWndParent,      // handle to owner window</span><br><span class="line">  DLGPROC lpDialogFunc  // dialog box procedure</span><br><span class="line">);</span><br></pre></td></tr></table></figure>



<blockquote>
<ul>
<li><p><em>hInstance</em> </p>
<p>[in] Handle to the module whose executable file contains the dialog box  template. </p>
</li>
<li><p><em>lpTemplate</em> </p>
<p>[in] Specifies the dialog box template. This parameter is either the pointer  to a null-terminated character string that specifies the name of the dialog box  template or an integer value that specifies the resource identifier of the  dialog box template. If the parameter specifies a resource identifier, its  high-order word must be zero and its low-order word must contain the identifier.  You can use the <a href="resource_2dd1.htm"><strong>MAKEINTRESOURCE</strong></a> macro to  create this value. </p>
</li>
<li><p><em>hWndParent</em> </p>
<p>[in] Handle to the window that owns the dialog box. </p>
</li>
<li><p><em>lpDialogFunc</em> </p>
<p>[in] Pointer to the dialog box procedure. For more information about the  dialog box procedure, see <a href="dlgboxes_5lib.htm"><strong>DialogProc</strong></a>. </p>
</li>
</ul>
</blockquote>
<p>第一个参数<code>hInstance</code>相当于<code>ImageBase</code>，第二个参数<code>lpTemplate</code>就是dialog需要的模板，这里就是我们之前自己手动生成的dialog，第三个参数<code>hWndParent</code>为父进程的句柄，如果没有父进程的话就写NULL，第四个参数<code>lpDialogFunc</code>就是当前窗口的消息处理函数</p>
<p>消息处理函数代码如下：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">BOOL CALLBACK <span class="title">DialogProc</span><span class="params">(									</span></span></span><br><span class="line"><span class="params"><span class="function">						 HWND hwndDlg,  <span class="comment">// handle to dialog box			</span></span></span></span><br><span class="line"><span class="params"><span class="function">						 UINT uMsg,     <span class="comment">// message			</span></span></span></span><br><span class="line"><span class="params"><span class="function">						 WPARAM wParam, <span class="comment">// first message parameter			</span></span></span></span><br><span class="line"><span class="params"><span class="function">						 LPARAM lParam  <span class="comment">// second message parameter			</span></span></span></span><br><span class="line"><span class="params"><span class="function">						 )</span>			</span></span><br><span class="line"><span class="function"></span>&#123;									</span><br><span class="line">									</span><br><span class="line">	<span class="built_in"><span class="keyword">switch</span></span>(uMsg)								</span><br><span class="line">	&#123;								</span><br><span class="line">	<span class="keyword">case</span>  WM_INITDIALOG :								</span><br><span class="line">									</span><br><span class="line">		<span class="built_in">MessageBox</span>(<span class="literal">NULL</span>,<span class="built_in">TEXT</span>(<span class="string">&quot;WM_INITDIALOG&quot;</span>),<span class="built_in">TEXT</span>(<span class="string">&quot;INIT&quot;</span>),MB_OK);							</span><br><span class="line">									</span><br><span class="line">		<span class="keyword">return</span> TRUE ;							</span><br><span class="line">									</span><br><span class="line">	<span class="keyword">case</span>  WM_COMMAND :								</span><br><span class="line">            </span><br><span class="line">		<span class="built_in"><span class="keyword">switch</span></span> (<span class="built_in">LOWORD</span> (wParam))							</span><br><span class="line">		&#123;							</span><br><span class="line">		<span class="keyword">case</span>   IDC_BUTTON_OK :							</span><br><span class="line">									</span><br><span class="line">			<span class="built_in">MessageBox</span>(<span class="literal">NULL</span>,<span class="built_in">TEXT</span>(<span class="string">&quot;IDC_BUTTON_OK&quot;</span>),<span class="built_in">TEXT</span>(<span class="string">&quot;OK&quot;</span>),MB_OK);						</span><br><span class="line">									</span><br><span class="line">			<span class="keyword">return</span> TRUE;						</span><br><span class="line">									</span><br><span class="line">		<span class="keyword">case</span>   IDC_BUTTON_ERROR:							</span><br><span class="line">									</span><br><span class="line">			<span class="built_in">MessageBox</span>(<span class="literal">NULL</span>,<span class="built_in">TEXT</span>(<span class="string">&quot;IDC_BUTTON_ERROR&quot;</span>),<span class="built_in">TEXT</span>(<span class="string">&quot;ERROR&quot;</span>),MB_OK);						</span><br><span class="line">									</span><br><span class="line">			<span class="built_in">EndDialog</span>(hwndDlg, <span class="number">0</span>);						</span><br><span class="line">									</span><br><span class="line">			<span class="keyword">return</span> TRUE;						</span><br><span class="line">		&#125;							</span><br><span class="line">		<span class="keyword">break</span> ;							</span><br><span class="line">    &#125;									</span><br><span class="line">									</span><br><span class="line">	<span class="keyword">return</span> FALSE ;								</span><br><span class="line">&#125;	</span><br></pre></td></tr></table></figure>



<p>这里我直接使用<code>IDD_DIALOG_MAIN</code>这个定义好了的宏发现报错，报错原因是不能够把int类型转为char*类型。在windows里面是不允许直接使用数字去查询的，跟上面所提到的<code>GetProcAddress()</code>函数一样，这里也需要使用指针去查询</p>
<p><img src="/images/win32/image-20210620233834254.png" alt="image-20210620233834254"></p>
<p><img src="/images/win32/image-20210620233808235.png" alt="image-20210620233808235"></p>
<p>这里可以使用<code>(char*) IDD_DIALOG_MAIN</code>进行强转，但是这里msdn里给我们定义了一个宏方便我们进行转型</p>
<blockquote>
<p>You can use the MAKEINTRESOURCE macro to create this value. </p>
</blockquote>
<p>那么这里就可以使用<code>MAKEINTRESOURCE (IDD_DIALOG_MAIN)</code>即可</p>
<p><img src="/images/win32/image-20210620234323295.png" alt="image-20210620234323295"></p>
<p>即可弹出窗口</p>
<p><img src="/images/win32/image-20210620234353567.png" alt="image-20210620234353567"></p>
<p>使用资源文件的话可以简化为两个步骤：创建窗口和提供消息处理函数</p>
<h2 id="按钮-amp-文本框"><a href="#按钮-amp-文本框" class="headerlink" title="按钮&amp;文本框"></a>按钮&amp;文本框</h2><p>双击资源文件，添加两个按钮，然后点击下方两个按钮即可调整为两个完全相同的按钮</p>
<p><img src="/images/win32/image-20210620234905046.png" alt="image-20210620234905046"></p>
<p><img src="/images/win32/image-20210620235018754.png" alt="image-20210620235018754"></p>
<p>右键点击属性进行修改</p>
<p><img src="/images/win32/image-20210620235227154.png" alt="image-20210620235227154"></p>
<p>回到<code>resource.h</code>发现又多了两个定义</p>
<p><img src="/images/win32/image-20210620235550092.png" alt="image-20210620235550092"></p>
<p>这里加一下两个按钮的消息处理函数</p>
<p><img src="/images/win32/image-20210621000120585.png" alt="image-20210621000120585"></p>
<p>F7编译运行看一下效果</p>
<p><img src="/images/win32/image-20210621000150472.png" alt="image-20210621000150472"></p>
<p><img src="/images/win32/image-20210621000200689.png" alt="image-20210621000200689"></p>
<p>继续再生成两个文本框，分别为<code>UserName</code>和<code>PassWord</code>，左边的为静态即写死了的文本框，右边的为动态即可编辑的对话框</p>
<p><img src="/images/win32/image-20210621000821115.png" alt="image-20210621000821115"></p>
<p>这里我想把<code>UserName</code>框和<code>PassWord</code>框里面的字符取出来打印，就需要以下两个步骤</p>
<ul>
<li>获取文本框句柄</li>
<li>获取文本框内容</li>
</ul>
<p>这里获取文本框句柄可以使用如下语句</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">HWND hEditUser = <span class="built_in">GetDlgItem</span>(hDlg,IDC_EDIT_USER);</span><br></pre></td></tr></table></figure>


    </article>
    <!-- license -->
    
        <div class="license-wrapper">
            <p>原文作者：<a href="http://example.com">Drunkmars</a>
            <p>原文链接：<a href="http://example.com/2021/06/17/win32/">http://example.com/2021/06/17/win32/</a>
            <p>发表日期：<a href="http://example.com/2021/06/17/win32/">June 17th 2021, 12:00:00 am</a>
            <p>更新日期：<a href="http://example.com/2021/06/17/win32/">June 21st 2021, 11:42:15 pm</a>
            <p>版权声明：本文采用<a rel="license noopener" target="_blank" href="http://creativecommons.org/licenses/by-nc/4.0/">知识共享署名-非商业性使用 4.0 国际许可协议</a>进行许可</p>
        </div>
    
    <!-- paginator -->
    <ul class="post-paginator">
        <li class="next">
            
                <div class="nextSlogan">Next Post</div>
                <a href="/2021/07/05/vmtest/" title="一种简单的反虚拟机调试方法">
                    <div class="nextTitle">一种简单的反虚拟机调试方法</div>
                </a>
            
        </li>
        <li class="previous">
            
                <div class="prevSlogan">Previous Post</div>
                <a href="/2021/06/16/C++%E4%BA%8C%E5%8F%89%E6%A0%91/" title="C++二叉树实现">
                    <div class="prevTitle">C++二叉树实现</div>
                </a>
            
        </li>
    </ul>
    <!-- comment -->
    
        <div class="post-comment">
            <!-- 来必力 City 版安装代码 -->


            

            

            

            <!-- utteranc评论 -->


            <!-- partial('_partial/comment/changyan') -->
            <!--PC版-->


            
            

        </div>
    
    <!-- timeliness note -->
    <!-- idea from: https://hexo.fluid-dev.com/posts/hexo-injector/#%E6%96%87%E7%AB%A0%E6%97%B6%E6%95%88%E6%80%A7%E6%8F%90%E7%A4%BA -->
    
    <!-- Mathjax -->
    
</main>

                <!-- profile -->
                
            </div>
            <footer class="footer footer-unloaded">
    <!-- social  -->
    
        <div class="social">
            
    
        
            
                <a href="mailto:drunkmars@vip.qq.com" class="iconfont-archer email" title=email ></a>
            
        
    
        
            
                <a href="https://github.com/Drunkmars" class="iconfont-archer github" target="_blank" title=github></a>
            
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
            
                <a href="https://twitter.com/Drunkmars404" class="iconfont-archer twitter" target="_blank" title=twitter></a>
            
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
            
                <a href="/atom.xml" class="iconfont-archer rss" target="_blank" title=rss></a>
            
        
    


        </div>
    
    <!-- powered by Hexo  -->
    <div class="copyright">
        <span id="hexo-power">Powered by <a href="https://hexo.io/" target="_blank">Hexo</a></span><span class="iconfont-archer power">&#xe635;</span><span id="theme-info">theme <a href="https://github.com/fi3ework/hexo-theme-archer" target="_blank">Archer</a></span>
    </div>
    <!-- website approve for Chinese user -->
    
    <!-- 不蒜子  -->
    
        <div class="busuanzi-container">
            
             
                <span id="busuanzi_container_site_pv">PV: <span id="busuanzi_value_site_pv"></span> :)</span>
            
        </div>
    	
</footer>

        </div>
        <!-- toc -->
        
            <div class="toc-wrapper toc-wrapper-loding" style=







    top:50vh;

>
                <div class="toc-catalog">
                    <span class="iconfont-archer catalog-icon">&#xe613;</span><span>CATALOG</span>
                </div>
                <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#win32-%E5%AE%BD%E5%AD%97%E8%8A%82"><span class="toc-number">1.</span> <span class="toc-text">win32 宽字节</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A4%9A%E5%AD%97%E8%8A%82%E5%AD%97%E7%AC%A6"><span class="toc-number">1.1.</span> <span class="toc-text">多字节字符</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#ascii"><span class="toc-number">1.1.1.</span> <span class="toc-text">ascii</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GB2312"><span class="toc-number">1.1.2.</span> <span class="toc-text">GB2312</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#C%E8%AF%AD%E8%A8%80%E4%B8%AD%E7%9A%84%E5%AE%BD%E5%AD%97%E7%AC%A6"><span class="toc-number">1.2.</span> <span class="toc-text">C语言中的宽字符</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%BD%E5%AD%97%E7%AC%A6%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="toc-number">1.2.1.</span> <span class="toc-text">宽字符的使用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%BD%E5%AD%97%E7%AC%A6%E4%B8%B2%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="toc-number">1.2.2.</span> <span class="toc-text">宽字符串的使用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9C%A8%E6%8E%A7%E5%88%B6%E5%8F%B0%E6%89%93%E5%8D%B0"><span class="toc-number">1.2.3.</span> <span class="toc-text">在控制台打印</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AD%97%E7%AC%A6%E4%B8%B2%E9%95%BF%E5%BA%A6"><span class="toc-number">1.2.4.</span> <span class="toc-text">字符串长度</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%A4%8D%E5%88%B6"><span class="toc-number">1.2.5.</span> <span class="toc-text">字符串复制</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#win32-API%E4%B8%AD%E7%9A%84%E5%AE%BD%E5%AD%97%E7%AC%A6"><span class="toc-number">1.3.</span> <span class="toc-text">win32 API中的宽字符</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#win32api"><span class="toc-number">1.3.1.</span> <span class="toc-text">win32api</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%87%8D%E8%A6%81dll"><span class="toc-number">1.3.2.</span> <span class="toc-text">重要dll</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Win32-API%E4%B8%AD%E7%9A%84%E5%AE%BD%E5%AD%97%E7%AC%A6%E5%92%8C%E5%A4%9A%E5%AD%97%E8%8A%82%E5%AD%97%E7%AC%A6"><span class="toc-number">1.3.3.</span> <span class="toc-text">Win32 API中的宽字符和多字节字符</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%90%84%E7%A7%8D%E7%89%88%E6%9C%AC%E7%9A%84MessageBox"><span class="toc-number">1.3.4.</span> <span class="toc-text">各种版本的MessageBox</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#win32%E7%9A%84%E5%85%A5%E5%8F%A3%E7%A8%8B%E5%BA%8F"><span class="toc-number">1.3.5.</span> <span class="toc-text">win32的入口程序</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9C%A8win32%E7%A8%8B%E5%BA%8F%E4%B8%AD%E6%89%93%E5%8D%B0%E4%BF%A1%E6%81%AF"><span class="toc-number">1.3.6.</span> <span class="toc-text">在win32程序中打印信息</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GetLastError-%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="toc-number">1.3.7.</span> <span class="toc-text">GetLastError()的使用</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BA%8B%E4%BB%B6-%E6%B6%88%E6%81%AF-%E6%B6%88%E6%81%AF%E5%A4%84%E7%90%86%E5%87%BD%E6%95%B0"><span class="toc-number">2.</span> <span class="toc-text">事件 消息 消息处理函数</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8B%E4%BB%B6%E4%B8%8E%E6%B6%88%E6%81%AF"><span class="toc-number">2.1.</span> <span class="toc-text">事件与消息</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#MSG%E7%BB%93%E6%9E%84"><span class="toc-number">2.1.1.</span> <span class="toc-text">MSG结构</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%B3%BB%E7%BB%9F%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97%E4%B8%8E%E5%BA%94%E7%94%A8%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97"><span class="toc-number">2.2.</span> <span class="toc-text">系统消息队列与应用消息队列</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E4%B8%80%E4%B8%AA%E5%9B%BE%E5%BD%A2%E7%95%8C%E9%9D%A2%E7%A8%8B%E5%BA%8F"><span class="toc-number">2.3.</span> <span class="toc-text">第一个图形界面程序</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#WNDCLASS%E7%BB%93%E6%9E%84"><span class="toc-number">2.3.1.</span> <span class="toc-text">WNDCLASS结构</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#windows%E6%B6%88%E6%81%AF%E8%8C%83%E5%9B%B4%E8%AF%B4%E6%98%8E"><span class="toc-number">2.4.</span> <span class="toc-text">windows消息范围说明</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#WindowProc%E7%BB%93%E6%9E%84%E6%8E%A2%E7%A9%B6"><span class="toc-number">2.5.</span> <span class="toc-text">WindowProc结构探究</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#ESP%E5%AF%BB%E5%9D%80-%E5%AE%9A%E4%BD%8D%E5%9B%9E%E8%B0%83%E5%87%BD%E6%95%B0"><span class="toc-number">3.</span> <span class="toc-text">ESP寻址 定位回调函数</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%B3%E4%BA%8E%E5%85%A5%E5%8F%A3%E5%87%BD%E6%95%B0%E7%9A%84%E6%8E%A2%E7%A9%B6"><span class="toc-number">3.1.</span> <span class="toc-text">关于入口函数的探究</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#WinMain%E7%BB%93%E6%9E%84"><span class="toc-number">3.1.1.</span> <span class="toc-text">WinMain结构</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#win32%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F%E5%85%A5%E5%8F%A3%E8%AF%86%E5%88%AB"><span class="toc-number">3.2.</span> <span class="toc-text">win32应用程序入口识别</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#GetModuleHandleA"><span class="toc-number">3.2.1.</span> <span class="toc-text">GetModuleHandleA</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ESP%E5%AF%BB%E5%9D%80"><span class="toc-number">3.3.</span> <span class="toc-text">ESP寻址</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AA%97%E5%8F%A3%E5%9B%9E%E8%B0%83%E5%87%BD%E6%95%B0%E7%9A%84%E5%AE%9A%E4%BD%8D"><span class="toc-number">3.4.</span> <span class="toc-text">窗口回调函数的定位</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%B7%E4%BD%93%E4%BA%8B%E4%BB%B6%E5%A4%84%E7%90%86%E7%9A%84%E5%AE%9A%E4%BD%8D"><span class="toc-number">3.5.</span> <span class="toc-text">具体事件处理的定位</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%AD%90%E7%AA%97%E5%8F%A3-%E6%B6%88%E6%81%AF%E5%A4%84%E7%90%86%E5%87%BD%E6%95%B0"><span class="toc-number">4.</span> <span class="toc-text">子窗口 消息处理函数</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9C%A8%E7%AA%97%E5%8F%A3%E4%B8%AD%E5%88%9B%E5%BB%BA%E6%8C%89%E9%92%AE"><span class="toc-number">4.1.</span> <span class="toc-text">在窗口中创建按钮</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8C%89%E9%92%AE%E4%BA%8B%E4%BB%B6%E7%9A%84%E5%A4%84%E7%90%86"><span class="toc-number">4.2.</span> <span class="toc-text">按钮事件的处理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#GetClassName"><span class="toc-number">4.2.1.</span> <span class="toc-text">GetClassName</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GetClassInfo"><span class="toc-number">4.2.2.</span> <span class="toc-text">GetClassInfo</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B6%88%E6%81%AF%E5%A0%86%E6%A0%88"><span class="toc-number">4.3.</span> <span class="toc-text">消息堆栈</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8C%89%E9%92%AE%E4%BA%8B%E4%BB%B6%E5%A4%84%E7%90%86%E9%80%BB%E8%BE%91%E5%AE%9A%E4%BD%8D"><span class="toc-number">4.4.</span> <span class="toc-text">按钮事件处理逻辑定位</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%B5%84%E6%BA%90%E6%96%87%E4%BB%B6-%E6%B6%88%E6%81%AF%E6%96%AD%E7%82%B9"><span class="toc-number">5.</span> <span class="toc-text">资源文件 消息断点</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%94%A8%E8%B5%84%E6%BA%90%E6%96%87%E4%BB%B6%E5%88%9B%E5%BB%BA%E5%AF%B9%E8%AF%9D%E6%A1%86"><span class="toc-number">5.1.</span> <span class="toc-text">用资源文件创建对话框</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#GetProcAddress"><span class="toc-number">5.1.1.</span> <span class="toc-text">GetProcAddress</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Dialogbox"><span class="toc-number">5.1.2.</span> <span class="toc-text">Dialogbox</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8C%89%E9%92%AE-amp-%E6%96%87%E6%9C%AC%E6%A1%86"><span class="toc-number">5.2.</span> <span class="toc-text">按钮&amp;文本框</span></a></li></ol></li></ol>
            </div>
        
        <!-- sidebar -->
        <div class="sidebar sidebar-hide">
    <ul class="sidebar-tabs sidebar-tabs-active-0">
        <li class="sidebar-tab-archives"><span class="iconfont-archer">&#xe67d;</span><span class="tab-name">Archive</span></li>
        <li class="sidebar-tab-tags"><span class="iconfont-archer">&#xe61b;</span><span class="tab-name">Tag</span></li>
        <li class="sidebar-tab-categories"><span class="iconfont-archer">&#xe666;</span><span class="tab-name">Cate</span></li>
    </ul>
    <div class="sidebar-content sidebar-content-show-archive">
        <div class="sidebar-panel-archives">
    <!-- 在 ejs 中将 archive 按照时间排序 -->
    
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
    
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
    
    
    
    
    <div class="total-and-search">
        <div class="total-archive">
        Total : 79
        </div>
        <!-- search  -->
        
    </div>
    
    <div class="post-archive">
    
        
            
            
            <div class="archive-year"> 2088 </div>
            <ul class="year-list">
            
        
        <li class="archive-post-item">
            <span class="archive-post-date">08/08</span>
            <a class="archive-post-title" href="/2088/08/08/readme/">README</a>
        </li>
    
        
            
            
                
                </ul>
            
            <div class="archive-year"> 2021 </div>
            <ul class="year-list">
            
        
        <li class="archive-post-item">
            <span class="archive-post-date">10/03</span>
            <a class="archive-post-title" href="/2021/10/03/dll%E5%8A%AB%E6%8C%81/">初探dll劫持</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">10/01</span>
            <a class="archive-post-title" href="/2021/10/01/dll%E6%B3%A8%E5%85%A5/">关于几种dll注入的学习</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">09/26</span>
            <a class="archive-post-title" href="/2021/09/26/%E5%86%85%E7%BD%91%E8%BD%AC%E5%8F%91/">浅谈内网转发与流量代理</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">09/13</span>
            <a class="archive-post-title" href="/2021/09/13/%E8%AE%B0%E4%B8%80%E6%AC%A1%E5%A4%96%E7%BD%91%E6%89%93%E7%82%B9%E5%88%B0%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/">记一次外网打点到内网渗透</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">08/23</span>
            <a class="archive-post-title" href="/2021/08/23/php/">php漏洞大杂烩</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">08/20</span>
            <a class="archive-post-title" href="/2021/08/20/struts2/">struts2漏洞总结</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">08/16</span>
            <a class="archive-post-title" href="/2021/08/16/tomcat/">tomcat漏洞大杂烩</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">08/09</span>
            <a class="archive-post-title" href="/2021/08/09/%E8%AE%B0%E4%B8%80%E6%AC%A1docker%E9%80%83%E9%80%B8%E5%AD%A6%E4%B9%A0/">记一次docker逃逸学习</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">08/04</span>
            <a class="archive-post-title" href="/2021/08/04/weblogic/">weblogic漏洞大杂烩</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">07/28</span>
            <a class="archive-post-title" href="/2021/07/28/%E7%AA%83%E5%8F%96hash/">浅谈域环境下布置水坑实现hash窃取</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">07/21</span>
            <a class="archive-post-title" href="/2021/07/21/%E8%AE%B0%E4%B8%80%E6%AC%A1%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E9%9D%B6%E5%9C%BA%E5%AD%A6%E4%B9%A0/">记一次内网渗透靶场学习</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">07/20</span>
            <a class="archive-post-title" href="/2021/07/20/redis/">redis漏洞总结</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">07/19</span>
            <a class="archive-post-title" href="/2021/07/19/spring/">spring漏洞总结</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">07/19</span>
            <a class="archive-post-title" href="/2021/07/19/%E4%B8%80%E6%AC%A1%E7%AE%80%E5%8D%95%E7%9A%84%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E9%9D%B6%E5%9C%BA%E5%AE%9E%E6%88%982/">一次简单的内网渗透靶场实战2</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">07/17</span>
            <a class="archive-post-title" href="/2021/07/17/%E7%BA%BF%E7%A8%8B%E5%90%8C%E6%AD%A5%E4%B8%8E%E7%BA%BF%E7%A8%8B%E4%BA%92%E6%96%A5/">线程同步与线程互斥</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">07/16</span>
            <a class="archive-post-title" href="/2021/07/16/win32%E4%B8%B4%E7%95%8C%E5%8C%BA%E4%BA%92%E6%96%A5%E4%BD%93/">临界区与互斥体</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">07/06</span>
            <a class="archive-post-title" href="/2021/07/06/%E4%B8%80%E6%AC%A1%E7%AE%80%E5%8D%95%E7%9A%84%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E9%9D%B6%E5%9C%BA%E5%AE%9E%E6%88%98/">一次简单的内网渗透靶场实战</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">07/05</span>
            <a class="archive-post-title" href="/2021/07/05/vmtest/">一种简单的反虚拟机调试方法</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">06/17</span>
            <a class="archive-post-title" href="/2021/06/17/win32/">win32</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">06/16</span>
            <a class="archive-post-title" href="/2021/06/16/C++%E4%BA%8C%E5%8F%89%E6%A0%91/">C++二叉树实现</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">06/15</span>
            <a class="archive-post-title" href="/2021/06/15/C++%E9%93%BE%E8%A1%A8/">C++链表实现</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">06/13</span>
            <a class="archive-post-title" href="/2021/06/13/msf%E7%94%9F%E6%88%90%E6%9C%A8%E9%A9%AC/">msf生成木马小结</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">06/11</span>
            <a class="archive-post-title" href="/2021/06/11/certutil%E6%8E%A2%E7%A9%B6/">certutil探究</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">06/10</span>
            <a class="archive-post-title" href="/2021/06/10/%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8%E6%80%BB%E7%BB%93/">横向移动总结</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">06/09</span>
            <a class="archive-post-title" href="/2021/06/09/mimikatz/">从mimikatz抓取密码学习攻防</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">06/08</span>
            <a class="archive-post-title" href="/2021/06/08/LLMNR%E5%92%8CNetBIOS%E6%AC%BA%E9%AA%97%E6%94%BB%E5%87%BB%E5%88%86%E6%9E%90%E5%8F%8A%E9%98%B2%E8%8C%83/">LLMNR和NetBIOS欺骗攻击分析及防范</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">06/04</span>
            <a class="archive-post-title" href="/2021/06/04/nullptr/">NULL、0、nullptr 区别分析</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">06/03</span>
            <a class="archive-post-title" href="/2021/06/03/C++/">C++</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">06/02</span>
            <a class="archive-post-title" href="/2021/06/02/RPC%E6%8F%90%E6%9D%83/">RPC提权</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">06/01</span>
            <a class="archive-post-title" href="/2021/06/01/UAC%E6%8F%90%E6%9D%83/">CVE-2019-1388 UAC提权</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">06/01</span>
            <a class="archive-post-title" href="/2021/06/01/%E7%BC%96%E5%86%99exp/">如何编写属于自己的第一个exp</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">05/29</span>
            <a class="archive-post-title" href="/2021/05/29/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/">读书笔记</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">05/28</span>
            <a class="archive-post-title" href="/2021/05/28/moonsec/">vulnhub靶场实战</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">05/27</span>
            <a class="archive-post-title" href="/2021/05/27/5%E6%9C%88%E7%A2%8E%E7%A2%8E%E5%BF%B5/">5月碎碎念</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">05/26</span>
            <a class="archive-post-title" href="/2021/05/26/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BC%B9shell%E7%9A%84%E5%A4%9A%E7%A7%8D%E6%96%B9%E5%BC%8F%E5%8F%8Abypass/">渗透测试中弹shell的多种方式及bypass</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">05/25</span>
            <a class="archive-post-title" href="/2021/05/25/CVE-2020-1472%E8%AF%A6%E8%A7%A3/">CVE-2020-1472详解</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">05/23</span>
            <a class="archive-post-title" href="/2021/05/23/%E4%BB%8E%E5%A4%96%E5%9B%B4%E6%89%93%E7%82%B9%E5%88%B0%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E6%8B%BF%E4%B8%8B%E5%9F%9F%E6%8E%A7/">从外围打点到内网渗透拿下域控</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">05/19</span>
            <a class="archive-post-title" href="/2021/05/19/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E4%B9%8B%E5%90%91%E6%97%A5%E8%91%B5%E5%A6%99%E7%94%A8/">内网渗透之向日葵妙用</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">05/12</span>
            <a class="archive-post-title" href="/2021/05/12/Dedecms%EF%BC%88%E7%BB%87%E6%A2%A6cms%EF%BC%89/">Dedecms(织梦cms)漏洞分析及复现</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">05/12</span>
            <a class="archive-post-title" href="/2021/05/12/EmpireCMS%EF%BC%88%E5%B8%9D%E5%9B%BDcms%EF%BC%89/">Empirecms(帝国cms)漏洞分析及复现</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">05/11</span>
            <a class="archive-post-title" href="/2021/05/11/CVE-2020-0796%E5%88%86%E6%9E%90%E5%8F%8A%E5%88%A9%E7%94%A8/">CVE-2020-0796分析及利用</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">05/11</span>
            <a class="archive-post-title" href="/2021/05/11/MS17_010%E6%A3%80%E6%B5%8B%E5%8F%8A%E6%89%93%E6%B3%95/">MS17_010检测及打法</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">05/11</span>
            <a class="archive-post-title" href="/2021/05/11/%E6%9C%A8%E9%A9%AC%E8%A7%A3%E6%9E%90&disable_fuctions/">木马解析&disable_fuctions</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">05/11</span>
            <a class="archive-post-title" href="/2021/05/11/%E7%AC%AC%E4%B8%80%E6%AC%A1hvv%E6%80%BB%E7%BB%93/">第一次hvv总结</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">05/08</span>
            <a class="archive-post-title" href="/2021/05/08/jboss%E4%B9%8BJMXInvokerServlet%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E5%88%A9%E7%94%A8/">jboss之JMXInvokerServlet反序列化漏洞分析利用</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">05/08</span>
            <a class="archive-post-title" href="/2021/05/08/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F%E7%9A%84n%E7%A7%8D%E5%A7%BF%E5%8A%BF/">内网穿透的n种姿势</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">05/06</span>
            <a class="archive-post-title" href="/2021/05/06/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0bypass%E5%AE%89%E5%85%A8%E7%8B%97/">文件上传bypass安全狗</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">04/28</span>
            <a class="archive-post-title" href="/2021/04/28/cs%E5%8A%A0%E8%BD%BD%E5%AE%8F%E4%B8%8A%E7%BA%BF%E5%88%9D%E6%8E%A2/">cs加载宏上线初探</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">04/27</span>
            <a class="archive-post-title" href="/2021/04/27/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E4%B9%8BDPAPI%E6%9C%BA%E5%88%B6%E5%AD%A6%E4%B9%A0/">内网渗透之DPAPI机制学习</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">04/20</span>
            <a class="archive-post-title" href="/2021/04/20/%E9%9A%90%E8%97%8F%E7%94%A8%E6%88%B7%E7%9A%84%E5%88%9B%E5%BB%BA%E5%92%8C%E4%BD%BF%E7%94%A8/">隐藏用户的创建和使用</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">04/19</span>
            <a class="archive-post-title" href="/2021/04/19/%E5%88%A9%E7%94%A8%E5%8D%B7%E5%BD%B1%E6%8B%B7%E8%B4%9D%E6%9C%8D%E5%8A%A1%E6%8F%90%E5%8F%96ntds.dit/">利用卷影拷贝服务提取ntds.dit</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">04/17</span>
            <a class="archive-post-title" href="/2021/04/17/%E4%B8%AD%E9%97%B4%E4%BA%BA%E6%AC%BA%E9%AA%97/">中间人攻击之arp欺骗</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">04/15</span>
            <a class="archive-post-title" href="/2021/04/15/%E6%B5%85%E8%B0%88%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%AD%E7%9A%84%E7%BB%84%E7%AD%96%E7%95%A5%E5%8F%8Agpp%E8%BF%90%E7%94%A8/">浅谈域渗透中组策略及gpp运用</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">04/14</span>
            <a class="archive-post-title" href="/2021/04/14/thinkphp%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E5%92%8C%E6%80%BB%E7%BB%93/">thinkphp漏洞分析与总结</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">04/13</span>
            <a class="archive-post-title" href="/2021/04/13/msf%E4%BD%BF%E7%94%A8%E8%AF%A6%E8%A7%A3/">msf使用详解</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">04/13</span>
            <a class="archive-post-title" href="/2021/04/13/sql%E6%B3%A8%E5%85%A5%E4%B9%8B%E8%B6%85%E8%AF%A6%E7%BB%86sqlmap%E4%BD%BF%E7%94%A8%E6%94%BB%E7%95%A5/">sql注入之超详细sqlmap使用攻略</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">04/10</span>
            <a class="archive-post-title" href="/2021/04/10/windows%E8%AE%A4%E8%AF%81%E8%A7%A3%E8%AF%BB/">windows认证解读</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">04/09</span>
            <a class="archive-post-title" href="/2021/04/09/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E4%B9%8B%E5%B7%A7%E7%94%A8smb%20beacon%E6%8B%BF%E4%B8%8B%E4%B8%8D%E5%87%BA%E7%BD%91%E4%B8%BB%E6%9C%BA/">巧用smb beacon拿下不出网主机</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">04/08</span>
            <a class="archive-post-title" href="/2021/04/08/phpmyadmin%E9%A1%B5%E9%9D%A2getshell/">phpmyadmin页面getshell</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">04/08</span>
            <a class="archive-post-title" href="/2021/04/08/windows%E7%8E%AF%E5%A2%83%E4%B8%8B%E6%8A%93%E5%AF%86%E7%A0%81%E6%80%BB%E7%BB%93/">windows环境下抓密码总结</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">04/06</span>
            <a class="archive-post-title" href="/2021/04/06/Kerberos%E5%8D%8F%E8%AE%AE&%E6%BC%8F%E6%B4%9E/">kerberos协议&漏洞</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">04/04</span>
            <a class="archive-post-title" href="/2021/04/04/Stega/">Stega</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">04/03</span>
            <a class="archive-post-title" href="/2021/04/03/PE/">PE</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">04/02</span>
            <a class="archive-post-title" href="/2021/04/02/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E5%91%BD%E4%BB%A4/">内网渗透命令</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">03/30</span>
            <a class="archive-post-title" href="/2021/03/30/IPC%E5%91%BD%E4%BB%A4&%E8%AE%A1%E5%88%92%E4%BB%BB%E5%8A%A1%E4%B8%8A%E7%BA%BF/">IPC命令&计划任务上线</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">03/29</span>
            <a class="archive-post-title" href="/2021/03/29/%E5%B8%B8%E7%94%A8%E7%AB%AF%E5%8F%A3%E6%80%BB%E7%BB%93/">常用端口总结</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">03/27</span>
            <a class="archive-post-title" href="/2021/03/27/mysql%E7%A6%BB%E7%BA%BF%E8%A7%A3%E6%9E%90%E5%AF%86%E7%A0%81/">mysql离线解析密码</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">03/27</span>
            <a class="archive-post-title" href="/2021/03/27/%E7%BB%95%E8%BF%87CDN%E6%89%BE%E6%BA%90%E7%AB%99ip/">绕过CDN找源站ip</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">03/27</span>
            <a class="archive-post-title" href="/2021/03/27/%E8%AE%B0%E4%B8%80%E6%AC%A1php%E3%80%81sql%E6%B3%A8%E5%85%A5%E5%AD%A6%E4%B9%A0%E5%90%8E%E7%9A%84%E4%B8%80%E9%81%93ctf%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%E9%A2%98%E5%A4%8D%E7%9B%98/">记一次php、sql注入学习后的一道ctf代码审计题复盘</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">03/26</span>
            <a class="archive-post-title" href="/2021/03/26/%E5%B0%8F%E7%99%BD%E7%9A%84%E7%AC%AC%E4%B8%80%E6%AC%A1sql%E5%AE%9E%E6%88%98/">小白的第一次sql实战</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">03/23</span>
            <a class="archive-post-title" href="/2021/03/23/crackme001/">crackme001</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">03/21</span>
            <a class="archive-post-title" href="/2021/03/21/certutil&wmic%E4%B8%8B%E8%BD%BD%E7%BB%95%E8%BF%87/">certutil&wmic绕过</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">03/17</span>
            <a class="archive-post-title" href="/2021/03/17/vps-java%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/">vps-java环境配置</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">03/16</span>
            <a class="archive-post-title" href="/2021/03/16/Joomla/">Joomla框架搭建&远程代码执行(RCE)漏洞复现</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">03/16</span>
            <a class="archive-post-title" href="/2021/03/16/jboss%E6%89%93%E5%85%A5%E5%86%85%E7%BD%91%E7%9A%84%E5%9B%9B%E7%A7%8D%E6%96%B9%E5%BC%8F/">jboss打入内网的四种方式</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">03/16</span>
            <a class="archive-post-title" href="/2021/03/16/sqlmap%E5%9C%A8https%E4%B8%8B%E6%8A%A5%E9%94%99%20-%20ssl%E8%BF%9E%E6%8E%A5%E5%A4%B1%E8%B4%A5/">sqlmap在https下的一种错误 - ssl连接失败</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">03/14</span>
            <a class="archive-post-title" href="/2021/03/14/%E6%B1%87%E7%BC%96%E8%AF%AD%E8%A8%80JCC%E6%8C%87%E4%BB%A4%E8%A1%A8/">汇编JCC指令表</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">03/13</span>
            <a class="archive-post-title" href="/2021/03/13/%E5%86%99%E5%9C%A8%E6%9C%80%E5%89%8D/">写在最前</a>
        </li>
    
    </div>
</div>

        <div class="sidebar-panel-tags">
    <div class="sidebar-tags-name">
        
            <span class="sidebar-tag-name" data-tags="碎碎念">
                <span class="iconfont-archer">&#xe606;</span>
                碎碎念
            </span>
        
            <span class="sidebar-tag-name" data-tags="private">
                <span class="iconfont-archer">&#xe606;</span>
                private
            </span>
        
            <span class="sidebar-tag-name" data-tags="二进制">
                <span class="iconfont-archer">&#xe606;</span>
                二进制
            </span>
        
            <span class="sidebar-tag-name" data-tags="C++">
                <span class="iconfont-archer">&#xe606;</span>
                C++
            </span>
        
            <span class="sidebar-tag-name" data-tags="内网渗透">
                <span class="iconfont-archer">&#xe606;</span>
                内网渗透
            </span>
        
            <span class="sidebar-tag-name" data-tags="cve">
                <span class="iconfont-archer">&#xe606;</span>
                cve
            </span>
        
            <span class="sidebar-tag-name" data-tags="漏洞复现">
                <span class="iconfont-archer">&#xe606;</span>
                漏洞复现
            </span>
        
            <span class="sidebar-tag-name" data-tags="cms">
                <span class="iconfont-archer">&#xe606;</span>
                cms
            </span>
        
            <span class="sidebar-tag-name" data-tags="web渗透">
                <span class="iconfont-archer">&#xe606;</span>
                web渗透
            </span>
        
            <span class="sidebar-tag-name" data-tags="kerberos">
                <span class="iconfont-archer">&#xe606;</span>
                kerberos
            </span>
        
            <span class="sidebar-tag-name" data-tags="域渗透">
                <span class="iconfont-archer">&#xe606;</span>
                域渗透
            </span>
        
            <span class="sidebar-tag-name" data-tags="横向移动">
                <span class="iconfont-archer">&#xe606;</span>
                横向移动
            </span>
        
            <span class="sidebar-tag-name" data-tags="提权">
                <span class="iconfont-archer">&#xe606;</span>
                提权
            </span>
        
            <span class="sidebar-tag-name" data-tags="ctf">
                <span class="iconfont-archer">&#xe606;</span>
                ctf
            </span>
        
            <span class="sidebar-tag-name" data-tags="cobalt strike">
                <span class="iconfont-archer">&#xe606;</span>
                cobalt strike
            </span>
        
            <span class="sidebar-tag-name" data-tags="apt">
                <span class="iconfont-archer">&#xe606;</span>
                apt
            </span>
        
            <span class="sidebar-tag-name" data-tags="java中间件">
                <span class="iconfont-archer">&#xe606;</span>
                java中间件
            </span>
        
            <span class="sidebar-tag-name" data-tags="msf命令">
                <span class="iconfont-archer">&#xe606;</span>
                msf命令
            </span>
        
            <span class="sidebar-tag-name" data-tags="oa">
                <span class="iconfont-archer">&#xe606;</span>
                oa
            </span>
        
            <span class="sidebar-tag-name" data-tags="中间件">
                <span class="iconfont-archer">&#xe606;</span>
                中间件
            </span>
        
            <span class="sidebar-tag-name" data-tags="mysql">
                <span class="iconfont-archer">&#xe606;</span>
                mysql
            </span>
        
            <span class="sidebar-tag-name" data-tags="sql">
                <span class="iconfont-archer">&#xe606;</span>
                sql
            </span>
        
            <span class="sidebar-tag-name" data-tags="thinkphp">
                <span class="iconfont-archer">&#xe606;</span>
                thinkphp
            </span>
        
            <span class="sidebar-tag-name" data-tags="web">
                <span class="iconfont-archer">&#xe606;</span>
                web
            </span>
        
            <span class="sidebar-tag-name" data-tags="环境配置">
                <span class="iconfont-archer">&#xe606;</span>
                环境配置
            </span>
        
            <span class="sidebar-tag-name" data-tags="windows api">
                <span class="iconfont-archer">&#xe606;</span>
                windows api
            </span>
        
            <span class="sidebar-tag-name" data-tags="bypass">
                <span class="iconfont-archer">&#xe606;</span>
                bypass
            </span>
        
            <span class="sidebar-tag-name" data-tags="php">
                <span class="iconfont-archer">&#xe606;</span>
                php
            </span>
        
            <span class="sidebar-tag-name" data-tags="hvv">
                <span class="iconfont-archer">&#xe606;</span>
                hvv
            </span>
        
            <span class="sidebar-tag-name" data-tags="靶场实战">
                <span class="iconfont-archer">&#xe606;</span>
                靶场实战
            </span>
        
            <span class="sidebar-tag-name" data-tags="权限维持">
                <span class="iconfont-archer">&#xe606;</span>
                权限维持
            </span>
        
    </div>
    <div class="iconfont-archer sidebar-tags-empty">&#xe678;</div>
    <div class="tag-load-fail" style="display: none; color: #ccc; font-size: 0.6rem;">
        缺失模块，请参考主题文档进行安装配置：https://github.com/fi3ework/hexo-theme-archer#%E5%AE%89%E8%A3%85%E4%B8%BB%E9%A2%98
    </div> 
    <div class="sidebar-tags-list"></div>
</div>

        <div class="sidebar-panel-categories">
    <div class="sidebar-categories-name">
    
    </div>
    <div class="iconfont-archer sidebar-categories-empty">&#xe678;</div>
    <div class="sidebar-categories-list"></div>
</div>

    </div>
</div>

        <!-- site-meta -->
        <script>
    var siteMeta = {
        root: "/",
        author: "Drunkmars"
    }
</script>

        <!-- import experimental options here -->
        <!-- Custom Font -->


        <!-- main func -->
        <script src="/scripts/main.js?v=20210823"></script>
        <!-- dark mode -->
        <script src="/scripts/dark.js?v=20210823"></script>
        <!-- fancybox -->
        <script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js" defer></script>
        <!-- algolia -->
        
        <!-- busuanzi -->
        
            <script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" async></script>
        
        <!-- CNZZ -->
        
        <!-- async load share.js -->
        
            <script src="/scripts/share.js?v=20210823" async></script>
        
        <!-- mermaid -->
        
    </body>
</html>
